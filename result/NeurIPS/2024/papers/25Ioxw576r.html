<html><head><meta charset='utf-8'><title>You Only Cache Once_ Decoder-Decoder Architectures for Language Models</title></head><body><h1>You Only Cache Once_ Decoder-Decoder Architectures for Language Models</h1><h3>By: ['Yutao Sun', 'Li Dong', 'Yi Zhu', 'Shaohan Huang', 'Wenhui Wang', 'Shuming Ma', 'Quanlu Zhang', 'Jianyong Wang', 'Furu Wei']</h3><hr><h4>publisher</h4><div style='margin-bottom:1em'>NeurIPS</div><h4>url</h4><div style='margin-bottom:1em'>https://neurips.cc/virtual/2024/oral/98001</div><h4>year</h4><div style='margin-bottom:1em'>2024</div><h4>abstract</h4><div style='margin-bottom:1em'> We introduce a decoder-decoder architecture, YOCO, for large language models, which only caches key-value pairs once. It consists of two components, i.e., a cross-decoder stacked upon a self-decoder. The self-decoder efficiently encodes global key-value (KV) caches that are reused by the cross-decoder via cross-attention. The overall model behaves like a decoder-only Transformer, although YOCO only caches once. The design substantially reduces GPU memory demands, yet retains global attention capability. Additionally, the computation flow enables prefilling to early exit without changing the final output, thereby significantly speeding up the prefill stage. Experimental results demonstrate that YOCO achieves favorable performance compared to Transformer in various settings of scaling up model size and number of training tokens. We also extend YOCO to 1M context length with near-perfect needle retrieval accuracy. The profiling results show that YOCO improves inference memory, prefill latency, and throughput by orders of magnitude across context lengths and model sizes.</div><h4>session</h4><div style='margin-bottom:1em'>Oral Session 6D: Deep Learning Architecture, Infrastructure</div><h4>pdf_url</h4><div style='margin-bottom:1em'>https://openreview.net/pdf?id=25Ioxw576r</div><h4>openreview_url</h4><div style='margin-bottom:1em'>https://openreview.net/forum?id=25Ioxw576r</div><h4>Baseline</h4><div style='margin-bottom:1em'>Oral Session 6D: Deep Learning Architecture, Infrastructure</div><h4>GreedyCohesive</h4><div style='margin-bottom:1em'>Oral Session 6D: Deep Learning Architecture, Infrastructure</div><h4>KMedoids</h4><div style='margin-bottom:1em'>Oral Session 6D: Deep Learning Architecture, Infrastructure</div><h4>KMeans</h4><div style='margin-bottom:1em'>Oral Session 6D: Deep Learning Architecture, Infrastructure</div></body></html>