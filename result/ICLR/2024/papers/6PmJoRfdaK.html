<html><head><meta charset='utf-8'><title>LongLoRA_ Efficient Fine-tuning of Long-Context Large Language Models</title></head><body><h1>LongLoRA_ Efficient Fine-tuning of Long-Context Large Language Models</h1><h3>By: ['Yukang Chen', 'Shengju Qian', 'Haotian Tang', 'Xin Lai', 'Zhijian Liu', 'Song Han', 'Jiaya Jia']</h3><hr><h4>publisher</h4><div style='margin-bottom:1em'>ICLR</div><h4>url</h4><div style='margin-bottom:1em'>https://iclr.cc/virtual/2024/oral/19790</div><h4>year</h4><div style='margin-bottom:1em'>2024</div><h4>abstract</h4><div style='margin-bottom:1em'> We present LongLoRA, an efficient fine-tuning approach that extends the context sizes of pre-trained large language models (LLMs), with limited computation cost.Typically, training LLMs with long context sizes is computationally expensive, requiring extensive training hours and GPU resources. For example, training on the context length of 8192 needs 16x computational costs in self-attention layers as that of 2048. In this paper, we speed up the context extension of LLMs in two aspects. On the one hand, although dense global attention is needed during inference, fine-tuning the model can be effectively and efficiently done by sparse local attention. The proposed shifted sparse attention effectively enables context extension, leading to non-trivial computation saving with similar performance to fine-tuning with vanilla attention. Particularly, it can be implemented with only two lines of code in training, while being optional in inference. On the other hand, we revisit the parameter-efficient fine-tuning regime for context expansion. Notably, we find that LoRA for context extension works well under the premise of trainable embedding and normalization. LongLoRA combines this improved LoRA with S^2-Attn. LongLoRA demonstrates strong empirical results on various tasks on Llama2 models from 7B/13B to 70B. LongLoRA extends Llama2 7B from 4k context to 100k, or Llama2 70B to 32k on a single 8x A100 machine. LongLoRA extends models' context while retaining their original architectures, and is compatible with most existing techniques, like Flash-Attention2. In addition, we further conduct supervised fine-tuning with LongLoRA and our long instruction-following LongAlpaca dataset. All our code, models, dataset, and demo are available at https://github.com/dvlab-research/LongLoRA.</div><h4>session</h4><div style='margin-bottom:1em'>Oral 1C</div><h4>pdf_url</h4><div style='margin-bottom:1em'>https://openreview.net/pdf?id=6PmJoRfdaK</div><h4>openreview_url</h4><div style='margin-bottom:1em'>https://openreview.net/forum?id=6PmJoRfdaK</div><h4>Baseline</h4><div style='margin-bottom:1em'>Oral 1C</div><h4>GreedyCohesive</h4><div style='margin-bottom:1em'>Oral 1C</div><h4>KMedoids</h4><div style='margin-bottom:1em'>Oral 1C</div><h4>KMeans</h4><div style='margin-bottom:1em'>Oral 4A</div></body></html>