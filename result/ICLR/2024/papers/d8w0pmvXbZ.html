<html><head><meta charset='utf-8'><title>Small-scale proxies for large-scale Transformer training instabilities</title></head><body><h1>Small-scale proxies for large-scale Transformer training instabilities</h1><h3>By: ['Mitchell Wortsman', 'Peter Liu', 'Lechao Xiao', 'Katie Everett', 'Alexander Alemi', 'Ben Adlam', 'John Co-Reyes', 'Izzeddin Gur', 'Abhishek Kumar', 'Roman Novak', 'Jeffrey Pennington', 'Jascha Sohl-Dickstein', 'Kelvin Xu', 'Jaehoon Lee', 'Justin Gilmer', 'Simon Kornblith']</h3><hr><h4>publisher</h4><div style='margin-bottom:1em'>ICLR</div><h4>url</h4><div style='margin-bottom:1em'>https://iclr.cc/virtual/2024/oral/19743</div><h4>year</h4><div style='margin-bottom:1em'>2024</div><h4>abstract</h4><div style='margin-bottom:1em'> Teams that have trained large Transformer-based models have reported training instabilities at large scale that did not appear when training with the same hyperparameters at smaller scales. Although the causes of such instabilities are of scientific interest, the amount of resources required to reproduce them has made investigation difficult. In this work, we seek ways to reproduce and study training instability at smaller scales. First, we focus on two sources of training instability described in previous work: the growth of logits in attention layers (Dehghani et al., 2023) and divergence of the output logits from the log probabilities (Chowdhery et al., 2022). By measuring the relationship between learning rate and loss across scales, we show that these instabilities also appear in small models when training at high learning rates, and that mitigations previously employed at large scales are equally effective in this regime. This prompts us to investigate the extent to which other known optimizer and model interventions influence the sensitivity of the final loss to changes in the learning rate. To this end, we study methods such as warm-up, weight decay, and the MuParam (Yang et al., 2022), and combine techniques to train small models that achieve similar losses across orders of magnitude of learning rate variation. Finally, to conclude our exploration we study two cases where instabilities can be predicted before they emerge by examining the scaling behavior of model characteristics such as activation and gradient norms.</div><h4>session</h4><div style='margin-bottom:1em'>Oral 7A</div><h4>pdf_url</h4><div style='margin-bottom:1em'>https://openreview.net/pdf?id=d8w0pmvXbZ</div><h4>openreview_url</h4><div style='margin-bottom:1em'>https://openreview.net/forum?id=d8w0pmvXbZ</div><h4>Baseline</h4><div style='margin-bottom:1em'>Oral 7A</div><h4>GreedyCohesive</h4><div style='margin-bottom:1em'>Oral 7D</div><h4>KMedoids</h4><div style='margin-bottom:1em'>Oral 7A</div><h4>KMeans</h4><div style='margin-bottom:1em'>Oral 7A</div></body></html>