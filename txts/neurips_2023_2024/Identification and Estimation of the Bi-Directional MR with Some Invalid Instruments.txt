Identiﬁcation and Estimation of the Bi-Directional
MR with Some Invalid Instruments
Feng Xie1, Zhen Yao1, Lin Xie1, Yan Zeng1,∗, Zhi Geng1
1Beijing Technology and Business University
Abstract
We consider the challenging problem of estimating causal effects from purely ob-
servational data in the bi-directional Mendelian randomization (MR), where some
invalid instruments, as well as unmeasured confounding, usually exist. To address
this problem, most existing methods attempt to ﬁnd proper valid instrumental vari-
ables (IVs) for the target causal effect by expert knowledge or by assuming that the
causal model is a one-directional MR model. As such, in this paper, we ﬁrst theo-
retically investigate the identiﬁcation of the bi-directional MR from observational
data. In particular, we provide necessary and sufﬁcient conditions under which
valid IV sets are correctly identiﬁed such that the bi-directional MR model is iden-
tiﬁable, including the causal directions of a pair of phenotypes (i.e., the treatment
and outcome). Moreover, based on the identiﬁcation theory, we develop a clus-
ter fusion-like method to discover valid IV sets and estimate the causal effects of
interest. We theoretically demonstrate the correctness of the proposed algorithm.
Experimental results show the effectiveness of our method for estimating causal
effects in both one-directional and bi-directional MR models.
1
Introduction
Mendelian randomization (MR) is a powerful method for estimating the causal effect of a potentially
modiﬁable risk factor (treatment) on disease (outcome) in observational studies, which has been used
across a wide variety of contexts, such as clinic [Mokry et al., 2015, Carreras-Torres et al., 2017],
socioeconomics [Cuellar-Partida et al., 2016, Brumpton et al., 2020], and drug targets [Ference et al.,
2015, Li et al., 2020]. Most existing MR methods assume a one-directional causal relationship.
However, bi-directional relationships are ubiquitous in real-life scenarios, for example, obesity and
vitamin D status [Vimaleswaran et al., 2013], body mass index (BMI) and type 2 diabetes (T2D), etc.
Understanding and analyzing bi-directional relationships can provide deeper insights into complex
systems, leading to more effective interventions and solutions.
Within a causal inference framework, MR can be implemented as a form of instrumental variables
(IVs) analysis in which genetic variants2 serve as IVs for the modiﬁable risk factor. Speciﬁcally, as
shown in Figure 1, suppose obesity (X) and Vitamin D status (Y ) are the treatment and outcome of
interest, respectively, and lifestyle factors (U) are the unmeasured confounders between them. One
can use genetic variants G as IVs to explore the causal effect of X on Y in observational data [Vi-
maleswaran et al., 2013] if G are valid IVs, i.e., G satisfy the following three assumptions [Wright,
1928, Goldberger, 1972, Bowden and Turkington, 1990, Hernán and Robins, 2006]:
A1. [Relevance] The genetic variants G are associated with the exposure X;
A2. [Exclusion Restriction] The genetic variants G have no direct pathway to the outcome Y ;
∗Corresponding author
2The genetic variants that act as IVs in MR studies are Single Nucleotide Polymorphisms (SNPs).
38th Conference on Neural Information Processing Systems (NeurIPS 2024).

A3. [Randomness] The genetic variants G are uncorrelated with unmeasured confounders U.
U
G
X
Y
%
(A1)
(A3)
%
(A2)
SNPs
Obesity
Vitamin D Status
Lifestyle Factors
Figure 1: Graphical illustration of a valid
IV model, where dashed lines indicate the
absence of arrows. G is a valid IV relative
to the causal relationship X →Y .
Figure 1 illustrates these three assumptions for a ge-
netic variant G that is a valid IV relative to the causal
relationship X →Y . Given a valid IV G in the lin-
ear model, one can estimate the causal effect of risk
factor X on the outcome Y of interest consistently
by using Two-Stage Least Squares (TSLS) [Burgess
et al., 2017]. However, in most MR studies, the ge-
netic variants may include some invalid IVs due to
horizontal pleiotropy−where some genetic variants
may have pleiotropic effects on both the treatment
X and the outcome Y via different biological path-
ways [Davey Smith and Ebrahim, 2003, Lawlor et al.,
2008]. How to select valid IVs from such genetic vari-
ants becomes the major issue in the MR study. In general, valid IVs need to be chosen based on
domain knowledge or expert experience [Richmond et al., 2017, Martens et al., 2006, Zhao et al.,
2023]. However, it is usually difﬁcult to select appropriate valid IVs without precise prior knowl-
edge of genetic variants, and an invalid IV may cause biased estimation of the effect of X on Y
[Sanderson et al., 2022, Richmond and Smith, 2022]. Therefore, it is desirable to investigate ways
of selecting genetic variants as valid IVs solely from observed variables.
Many contributions have been made to handle MR studies with some invalid IVs under speciﬁc as-
sumptions. Existing methods can be roughly divided into four strategies. The ﬁrst strategy assumes
the InSIDE assumption, which states that the genetic variants’ pleiotropic effects on the outcome Y
are uncorrelated with their effects on the exposure X, and requires that the number of IVs increases
with the sample size [Bowden et al., 2015]. The second strategy is based on the Majority rule as-
sumption, which assumes that over 50% of the candidate IVs are valid [Kang et al., 2016, Bowden
et al., 2016, Windmeijer et al., 2019, Hartford et al., 2021]. The third strategy assumes the Plurality
rule assumption, which means that the number of valid IVs is larger than any number of invalid IVs
with the same ratio estimator limit [Guo et al., 2018, Windmeijer et al., 2021]. The last strategy
assumes the Two-Valid IVs assumption, which requires that the number of valid IVs is greater than
or equal to 2, and the Rank-faithfulness assumption, which states that the probability distribution P
is rank-faithful to a directed acyclic graph G if every rank constraint on a sub-covariance matrix that
holds in P is entailed by every linear structural model with respect to G [Silva and Shimizu, 2017,
Xie et al., 2022, Cheng et al., 2023]. Although these methods have been used in various ﬁelds, they
assumed that the one-directional causal relationship between X and Y is known and may fail to
handle scenarios where bi-directional relationships are present.
Recently, Darrous et al. [2021] proposed a latent heritable confounder MR method to estimate bi-
directional causal effects with a hierarchical prior on the true parameters. However, their method is
sensitive to prior misspeciﬁcation. Later, Li and Ye [2022] introduced a focusing framework to test
bi-directional causal effects under the noise distribution of the effect estimates assumption, which is
exciting. However, this assumption is strictly parameterized (See Condition 1 in [Li and Ye, 2022]
for more details). Moreover, they focus on the two-sample MR model that assumes homogeneity
across samples, whereas we consider the one-sample MR model. See Appendix A for more details.
In this paper, we aim to investigate the identiﬁability of the one-sample bi-directional MR model
and to provide an estimation method. Speciﬁcally, we make the following contributions:
1. We present sufﬁcient and necessary conditions for the identiﬁability of the bi-directional MR
model, enabling both valid IV sets for each direction and the causal effects of interests to be
correctly identiﬁed.
2. We propose a practical and effective cluster fusion-like algorithm for unbiased estimation. This
algorithm correctly identiﬁes which IVs are valid, determines the causal directions to which the
valid IV sets belong, and estimates the bi-directional causal effects.
3. Extensive experiments demonstrate the efﬁcacy of the proposed algorithms in MR models.
2
Model Deﬁnition and IV Estimator
2.1
Bi-Directional MR Causal Models
Suppose we have n independent samples (Xi, Yi, Gi) from the distribution of (X, Y, G), where
X ∈R and Y ∈R is a pair of phenotypes of interest, and G = (G1, G2, . . . , Gg)⊺∈Rg denotes
2

measured genetic variants, which may include invalid IVs. Analogous to Li and Ye [2022], for
each sample, indexed by i, the phenotype Xi is taken as a linear function of the phenotype Yi,
genetic variants Gi, and an error term εXi, while phenotype Yi is modeled as a linear function of
the phenotype Xi, genetic variants Gi, and an error term εYi. Without loss of generality, we assume
that all variables have a zero mean (otherwise can be centered). Speciﬁcally, the generating process
of the data is given below:
X = Y βY →X + G⊺γX + εX,
Y = XβX→Y + G⊺γY + εY ,
(1)
where βY →X is the causal effect of Y on X and βX→Y is that of X on Y . γX = (γX,1, ..., γX,g)⊺
and γY = (γY,1, ..., γY,g)⊺are the direct effects of genetic variants G on X and Y , respectively.
Note that εX and εY are error terms that are correlated due to unmeasured confounders U between
X and Y . Besides, there may exist a single genetic variant Gi ∈G with both γX,i ̸= 0 and γY,i ̸= 0,
which implies that Gi also has a direct pathway to the outcome, violating Assumption A2 [Exclusion
Restriction]. Like Li and Ye [2022], we here restrict the independence between any two genetic
variants in G (i.e., genetic variants are randomized). In Section 5, we discuss the situation where
this restriction is violated. Unlike Li and Ye [2022], we allow genetic variants to cause unmeasured
confounders (partially violating Assumption A3 [Randomness]).
Following Hausman [1983],
we assume that βX→Y βY →X
̸=
1.
Then let ∆
=
1/(1 −βX→Y βY →X), Eq.(1) can be reorganized to avoid recursive formulations as follows:
X = (G⊺γX + G⊺γY βY →X + εX + εY βY →X)∆,
Y = (G⊺γXβX→Y + G⊺γY + εXβX→Y + εY )∆.
(2)
If βX→Y βY →X = 1, the causal effects βX→Y and βY →X are not identiﬁable, even in the presence
of a valid IV.
Goal. In this paper, we aim to address whether the bi-directional MR model in Eq.(1) is identiﬁ-
able; that is, whether we can estimate the causal effects βX→Y and βY →X given inﬁnite data, even
without prior knowledge about which candidate IVs are valid or invalid.
2.2
IV Estimator
In this section, we brieﬂy describe the classical IV estimator, the two-stage least squares (TSLS)
estimator, which is capable of consistently estimating the causal effects βX→Y and βY →X of interest
in the above bi-directional MR causal model of Eq.(1) when the valid IVs are known [Wooldridge,
2010]. We denote by GX→Y
V
the set consisting of all valid IVs in G relative to X →Y , and GX→Y
I
the set that consists of at least one invalid IV in G relative to X →Y . Similar notations are applied
to the inverse causal relationship Y →X, i.e., GY →X
V
and GY →X
I
.
Proposition 1 (Two Stage Least Square (TSLS) Estimator). Assume the system is a linear bi-
directional causal model 1. For a given causal relationship X →Y in the system, the causal
effect of X on Y can be identiﬁed by
ˆβX→Y = [X⊺PX]−1 X⊺PY = βX→Y ,
(3)
where P = (GX→Y
V
)⊺
GX→Y
V
(GX→Y
V
)⊺−1 GX→Y
V
is the projection matrix.
Remark 1. Note that, when utilizing the TSLS estimator, the causal effect is biased if the candidate
set G includes invalid IVs. For instance, consider the causal relationship X →Y , given an invalid
IV set GX→Y
I
, the causal effect of X on Y is given by
ˆβX→Y =
h
X⊺˜PX
i−1
X⊺˜PY
= βX→Y +
h
X⊺˜PX
i−1
X⊺˜P(G⊺γY + εY )
|
{z
}
βbias
,
where ˜P = (GX→Y
I
)⊺
GX→Y
I
(GX→Y
I
)⊺−1 GX→Y
I
.
In the remaining of the paper, we denote such a procedure by ˆβX→Y = TSLS(X, Y, GX→Y ).
Similarly, for causal relationship Y →X, one can also have the corresponding causal effect of
Y on X given the set of IVs, i.e., ˆβY →X = TSLS(Y, X, GY →X). For details about the proof of
Proposition 1 and Remark 1, please refer to Appendix G.1 and G.2.
3

3
Identiﬁability of Bi-Directional MR Model
In this section, we ﬁrst show by a simple example that the valid and invalid IV sets can impose
different constraints. Then, we formulate these constraints and present the necessary and sufﬁcient
conditions that render the model identiﬁable.
3.1
A Motivating Example
U
G1
G2
G3
G4
G5
X
Y
Figure 2: An illustrative example where
valid and invalid IV sets induce distinct
constraints, where GX→Y
V
= (G1, G3)⊺
is a valid IV set, while GX→Y
I
=
(G2, G4, G5)⊺is invalid due to pathways
G2 →Y , G4 →Y and G5 →Y .
Figure 2 gives an illustration of our basic idea. Suppose
there are 2 valid IVs, i.e., G1 and G3, and 3 invalid IVs,
i.e., G2, G4 and G5, relative to the causal relationship
X →Y . For the inverse Y →X, identical conclu-
sions can be derived. Assume the generating process
of X and Y follows Eq.(1), where speciﬁcally we set
all variables to have a zero mean and unit variance and
X = Y βY →X+G1γX,1+G2γX,2+G3γX,3+G4γX,4+
G5γX,5 +εX, and Y = XβX→Y +G2γY,2 +G4γY,4 +
G5γY,5 + εY , where βX→Y = βY →X = 0.6, γX,1 =
γX,2 = γX,3 = 1, γX,4 = 1.8, γX,5 = 1.2, γY,2 =
0.5, γY,4 = 0.6, γY,5 = 0.3.
Interestingly, we have the following observations:
Observation 1.
Given a valid IV set where there are
at least two IVs , e.g., GX→Y
V
= (G1, G3)⊺, we have:
corr(Y −Xω{G3}, G1) = 0,
corr(Y −Xω{G1}, G3) = 0,
where corr(·) denotes the Pearson’s correlation coefﬁcient between two random variables, and
ω{Gi} = TSLS(X, Y, {Gi}) with i ∈{1, 3}.
Observation 2.
However, given an invalid IV set, e,g., GX→Y
I
= (G2, G4, G5)⊺, we have:
corr(Y −Xω{G4,G5}, G2) ̸= 0, corr(Y −Xω{G2,G5}, G4) ̸= 0, corr(Y −Xω{G2,G4}, G5) ̸= 0,
where ω{Gi,Gj} = TSLS(X, Y, {Gi, Gj}) with i ̸= j and i, j ∈{2, 4, 5}.
Based on these two observations, we can see that the valid and invalid IV sets entail clearly different
constraints regarding the correlation coefﬁcients3, which inspires us to further derive our identiﬁca-
tion analysis. For details about the observations, please refer to Appendix C.
3.2
Main Identiﬁcation Results
We begin with the following deﬁnition and the main assumptions.
Deﬁnition 1. (Pseudo-Residual) Let G be a subset of candidate genetic variants. A pseudo-residual
of {X, Y } relative to G is deﬁned as
PR(X,Y | G) := Y −XωG,
(4)
where ωG = TSLS(X, Y, G).
This “pseudo-residual" is applied to measure the uncorrelated relationship with some genetic vari-
ants. Note that concepts to “pseudo-residual" have been developed to address different tasks [Drton
and Richardson, 2004, Chen et al., 2017, Cai et al., 2019, Xie et al., 2020], but our formalization is
different from theirs in terms of the parameter ωG. To the best of our knowledge, it has not been
realized that the uncorrelated property involving such pseudo-residuals reﬂects the validity of the
IVs in the bi-directional MR causal model (see Propositions 2 ∼3).
As analyzed by Chu et al. [2001], within the framework of linear models, a variable being a valid
IV imposes no constraints on the joint marginal distribution of the observed variables. In other
words, there is no available test to determine whether a variable is a valid IV without making further
assumptions. Therefore, we introduce the following assumption.
Assumption 1 (Valid IV Set). For a given causal relationship (if the relationship exists), there exists
a valid IV set that consists of at least two valid IVs. For example, for the causal relationship X →Y ,
|GX→Y
V
| ≥2.
3Please note that these constraints can be tested easily by observed data.
4

Assumption 1 is the same as in [Silva and Shimizu, 2017, Cheng et al., 2023] if the model is a
one-directional MR model. Notice that this assumption is much milder than the Majority rule as-
sumption [Kang et al., 2016, Bowden et al., 2016, Windmeijer et al., 2019, Hartford et al., 2021]
and Plurality rule assumption [Guo et al., 2018, Windmeijer et al., 2021]: Assumption 1 does not
rely on the total number of genetic variants, while Majority rule and Plurality rule assumptions do.
We now show that under Assumption 1, one can identify the class of invalid IV sets.
Proposition 2 (Identifying Invalid IV Sets). Let G = {G1, . . . , Gp}, p ≥2 be a subset of candidate
genetic variants G. Suppose that Assumption 1 and the size of participants n →∞hold. If there
exists a Gj ∈G such that,
corr(PR(X,Y | G\Gj), Gj) ̸= 0,
(5)
then G is an invalid IV set for any one of the causal relationships.
Proposition 2 is valuable when given a set of genetic variants but lack prior knowledge of the validity
of IV sets. By testing speciﬁc correlations in Eq.(5), we can conclude that the current IV set is
invalid.
Example 1. Consider the example in Figure 2. Suppose G = {G1, G2}, according to Proposition 2
we have corr(PR(X,Y | {G2}), G1) ̸= 0. Thus G is an invalid IV set.
U
G2
G1
X
Y
(a)
U
G2
G1
X
Y
(b)
Figure 3: An illustrative example that valid and
invalid IV sets may induce the same constraints in
Eq.(5) of Proposition 2, where {G1, G2} is the set
of valid IVs in (a), while invalid in (b). It implies
Assumption 1 is not sufﬁcient to ﬁnd valid IV sets.
One may naturally raise the following ques-
tion: Can all the invalid IV sets be identiﬁed by
Proposition 2? In other words, can we identify
all the valid IV sets? Unfortunately, Assump-
tion 1 is an insufﬁcient condition for identifying
the sets of valid IVs. See an illustrative exam-
ple below.
Example 2 (Counterexample). Consider the ex-
ample in Figure 3. Suppose G = {G1, G2}. In
subgraph (a), for G1 ∈G, according to Propo-
sition 2 we obtain
corr(PR(X,Y | {G2}), G1) = 0
(6)
Similarly, for G2 ∈G, we have
corr(PR(X,Y | {G1}), G2) = 0
(7)
In subgraph (b), for G1 ∈G, we check the condition of Proposition 2 and obtain
corr(PR(X,Y | {G2}), G1) = γY,1γX,2 −γY,2γX,1
βY →XγY,2 + γX,2
.
(8)
Similarly, for G2 ∈G, we have
corr(PR(X,Y | {G1}), G2) = γY,2γX,1 −γY,1γX,2
βY →XγY,1 + γX,1
.
(9)
We know that {G1, G2} is an invalid IV set in this case. However, if the proportion of effects of G1
on X and Y is equal to the proportion of the effects of G2 on X and Y , i.e., γX,1γY,2 = γY,1γX,2,
we have
corr(PR(X,Y | {G2}), G1) = 0,
corr(PR(X,Y | {G1}), G2) = 0,
which is consistent with the conclusion of subgraph (a). These observations imply that one can not
identify valid IV sets under only Assumption 1.
To give sufﬁcient conditions for identifying valid IV sets, we ﬁrst introduce the following assump-
tion.
Assumption 2 (Generic Identiﬁability). For a given MR causal model, parameters γ and β live in
a set of Lebesgue measure non-zero.
5

In other words, Assumption 2 speciﬁcally implies that given a general subset of candidate genetic
variants G, there exists a Gj ∈G that satisﬁes | P
Gi∈G/Gj ¯βicov(Gi, Gi)[(γX,i +γX,UγU,i)(γY,j +
γY,UγU,j)−(γY,i +γY,UγU,i)(γX,j +γX,UγU,j)]| ̸= 0, where ¯βi ̸= 0 is the estimated coefﬁcient be-
tween Gi and X. For instance, in Example 2, such an assumption simpliﬁes to γX,1γY,2 ̸= γY,1γX,2.
Whenever γX,1γY,2 = γY,1γX,2, parameters γ and β would fall into a set of Lebesgue measure zero,
rendering non-identiﬁable of the model. It is worth noting that in real life, although we cannot ob-
tain the ground truths of causal effects between variables, especially when latent confounders are
involved, Assumption 2 is generally satisﬁed. This is because the set of conditions to violate it
occupies a very small portion of the entire space.
With Assumption 2, we now derive sufﬁcient conditions for generic identiﬁability in Proposition 3.
Proposition 3 (Identifying Valid IV Sets). Let G = {G1, . . . , Gp}, p ≥2 be a subset of candidate
genetic variants G. Suppose that Assumptions 1 and 2, and the size of participants n →∞hold. If
each Gj ∈G satisﬁes
corr(PR(X,Y | G\Gj), Gj) = 0,
(10)
then G is a proper valid IV set for one of the causal relationships, i.e., G ⊆GX→Y
V
or G ⊆GY →X
V
.
Proposition 3 indicates that, under Assumptions 1 and 2, we are able to identify a subset that consists
of valid IVs for one of the relationships, from the candidate genetic variants G. Here, it should be
noted that in a bi-directional MR model (with both βX→Y ̸= 0 and βY →X ̸= 0), one cannot
determine whether the identiﬁed IV set G is related to the causal relationship X →Y or Y →X.
To address this, we here introduce the following conditions that allow the estimated valid IV sets to
determine the direction.
Assumption 3. In a bi-directional MR model, for a given causal relationship X →Y , β2
X→Y ·
Var(X) < Var(Y ). Similarly, for a given causal relationship Y →X, β2
Y→X · Var(Y ) ≤Var(X).
Assumption 3 is a very natural condition that one expects to hold for the unique identiﬁability of valid
IVs for the bi-directional model. This assumption is often reasonable in MR models as discussed in
Xue and Pan [2020]. One may refer to Pages 4∼5 in Xue and Pan [2020] for more details.
Proposition 4 (Identifying Direction of Causal Inﬂuences). Suppose Assumption 3 holds. Given a
valid IV set denoted as G, if each Gj ∈G satisﬁes the condition |corr(Gj, Y )/corr(Gj, X)| < 1,
then G is a valid IV set for the causal relationship X →Y , i.e., G ⊆GX→Y
V
. Conversely, if this
condition is not satisﬁed, G is a valid IV set for the causal relationship Y →X, i.e., G ⊆GY →X
V
.
Proposition 4 indicates that, under Assumption 3, it is possible to ascertain the directional orientation
of the identiﬁed IV sets. Thus, with Propositions 2∼4, we have sufﬁcient and necessary conditions
under which the bi-directional MR model is fully identiﬁable, formalized as follows:
Theorem 1 (Identiﬁability of Bi-directional MR model). Suppose that Assumptions 1 ∼3, and the
size of participants n →∞hold, the Bi-directional MR model is fully identiﬁable, which includes
the identiﬁcation of valid IV sets, the causal relationships the identiﬁed sets relate to, the causal
directions between X and Y , and the causal effects of X on Y as well as of Y on X.
4
PReBiM Algorithm
In this section, we leverage the above theoretical results and propose a data-driven algorithm, PRe-
BiM (Pseudo-Residual-based Bi-directional MR), for estimating the causal effects of interest. It
contains two key steps, ﬁnding valid IV sets (Step I), and inferring causal direction and estimat-
ing the causal effects given the identiﬁed valid IV sets (Step II). The algorithm is designed with
the following rules, which are proved correct: (1) valid IV sets can be correctly discovered given
the measured genetic variants (Section 4.1), and (2) the causal direction and causal effects can be
uniquely identiﬁed (Section 4.2). The entire process is summarized in Algorithm 1.
Algorithm 1 PReBiM
Input: A dataset of measured genetic variants G = (G1, ..., Gg)⊺, two phenotypes X and Y ,
signiﬁcance level α, and parameter W, maximum number of IVs to consider.
1: Valid IV sets V ←FindValidIVSets(G, X, Y , α, W);
▷Step I
2: (ˆβX→Y , ˆβY →X) ←InferCausalDirectionEffects(X, Y , V);
▷Step II
Output: ˆβX→Y and ˆβY →X, the causal effects of X on Y and Y on X, respectively.
6

4.1
Step I: Finding Valid IV Sets
Propositions 2 and 3 have paved the way to distinguish the invalid and valid IV sets, respectively.
This enables us to use a cluster fusion-like method to discover the valid IV sets4. To improve the
algorithm’s effectiveness with a ﬁnite sample size, especially when the pool of candidate genetic
variants G is substantial, we introduce a parameter W, representing the maximum number of instru-
mental variables (IVs) to consider. This approach aims to circumvent the necessity of identifying
the largest IV set within the collection, thereby minimizing the need for IV validity testing.
The basic process is provided in Algorithm 2. Due to limited space, the speciﬁc details of algorithm
execution are provided in Appendix E. In practice, we check for the valid IV test, i.e., Eq.(10), with
the Pearson Correlation Test using the Fisher transformation [Anderson, 2003], denoted by PCT.
Algorithm 2 FindValidIVSets
Input: A dataset of measured genetic variants G = (G1, ..., Gg)⊺, two phenotypes X and Y ,
signiﬁcance level α, and parameter W, maximum number of IVs to consider.
1.
Initialize valid IV sets V = ∅and ˜G = G.
2.
Find Vnew with |G| = 2 according to minimize the sum of correlation between pseudo-residual
PR(X,Y | G\Gi) and Gi, where Gi ∈G and G ∈˜G.
3.
Update Vnew by incrementally adding genetic variant Gk until it is impossible to add variables
without passing PCT or the length of the set Vnew reaches our predetermined threshold W.
4.
Repeat Step 1 and Step 2 to ﬁnd another V′
new. If V is empty, add V′
new to V. If not, and
the combined set {V ∪V′
new} passes the PCT, merge them; otherwise, discard V′
new. Stop the
iteration when V contains two sets of IVs or when there is one or fewer genetic variants left in
˜G.
Output: V, a set that collects the valid IV sets.
4.2
Step II: Inferring Causal Direction and Estimating the Causal Effects
In this section, we infer the causal direction and estimate the causal effects given the identiﬁed valid
IV sets. The basic process is provided in Algorithm 3. Due to limited space, the speciﬁc details of
algorithm execution are provided in Appendix F.
Algorithm 3 InferCausalDirectionEffects
Input: Two phenotypes X and Y , Valid IV sets V.
1.
Infer the causal direction corresponding to the valid IV set V based on Proposition 4.
2.
Calculate the ﬁnal causal effects ˆβX→Y and ˆβY →X by TSLS(·).
Output: ˆβX→Y and ˆβY →X
4.3
Correctness of PReBiM Algorithm
In this section, we show that, in the large sample limit, for the causal relationships of interest X ↔Y ,
the causal effects ˆβX→Y and ˆβY →X obtained through the proposed method are unbiased.
Theorem 2 (Correctness). Assume that the data {X, Y } and G strictly follow Eq.(1) and Assump-
tions 1 ∼3 hold. Given inﬁnite samples, the PReBiM algorithm outputs the true causal effects
βX→Y and βY →X correctly.
4.4
Complexity of PReBiM Algorithm
We give the computational complexity analysis as follows.
First, the complexity of ﬁnd-
ing a valid IV set Vnew of length 2 is O
 2
 g
2

, where g is the number of IVs.
Then,
the complexity of expanding Vnew to the length W is O

(2g−W −2)(W −1)
2

, where W is
the maximum length of the IV set.
For ﬁnding additional valid IV sets, the number of
loops, t, must satisfy t
≤
g−4
W .
The complexity of ﬁnding the second valid IV set of
length
W
is
given
by
O
Pt
k=1

2
 g−kW
2

+ (2g−(2k+1)W −2)(W −1)
2

+ 2W(t −1) + 1

.
4A cluster is considered a valid IV set, and the term "fusion-like" refers to the speciﬁc process of identifying
and merging these clusters.
7

Therefore,
the
total
computational
complexity
of
the
PReBiM
algorithm
is
O
Pt
k=0

2
 g−kW
2

+ (2g−(2k+1)W −2)(W −1)
2

+ 2W(t −1) + 1

.
5
Discussion
U
G2
G1
X
Y
(a)
U
G2
G1
X
Y
(b)
Figure
4:
Simple
examples,
where
{G1, G2} is a valid IV set in (a), whereas
invalid in (b).
The preceding sections demonstrate that a valid IV set
can be identiﬁed when any two genetic variants in G
are independent. In this section, we explore whether
the main results of Propositions 2 and 3 remain appli-
cable when some genetic variants in G are dependent.
As shown in Figure 4 (b), we evaluate the condition of
Proposition 2 and ﬁnd that corr(PR(X,Y,|G2), G1) ̸=
0 and corr(PR(X,Y,|G1), G2) ̸= 0. This indicates
that {G1, G2} is an invalid IV set. Conversely, in Fig-
ure 4 (a), when assessing the condition of Proposition
3, we observe that corr(PR(X,Y,|G2), G1) = 0 and corr(PR(X,Y,|G1), G2) = 0, suggesting that
{G1, G2} is a valid IV set. Consequently, it is interesting to note that even with such dependence
between genetic variants, our main results may still be effective in identifying valid IV sets. In Ap-
pendix H.1 ∼H.2, we further demonstrate the practicality of our method for this example. As for
the complex scenarios where there is confounding among genetic variants or between the genetic
variants and some phenotype, or where there exist genetic variants that are associated with another
phenotype while this phenotype causes X and Y , we leave them into our future work.
6
Experimental Results
In this section, we conduct various simulation studies to evaluate the performance of the proposed
PReBiM method. The methods we compare against are: 1) NAIVE, the least-squares regression
method; 2) MR-Egger [Bowden et al., 2015]; 3) sisVIVE algorithm [Kang et al., 2016] 5; 4) IV-
TETRAD algorithm[Silva and Shimizu, 2017] 6; 5) TSHT algorithm [Guo et al., 2018] 7; and 6)
PReBiM, our method. The second method, MR-Egger, is speciﬁcally for MR studies with invalid
IVs. The last four methods are capable of handling the one-sample MR model in the presence of
unmeasured confounders. Our source code can be found in the Supplementary Materials.
Experimental setup. To compare the performance of these methods in a realistic setting, analogous
to Slob and Burgess [2020], the genetic variants are modeled as Single Nucleotide Polymorphisms
(SNPs), with a varying minor allele frequency maf j, and take values 0, 1, or 2. The minor allele
frequencies are drawn from a uniform distribution. Speciﬁcally, the data generation process for the
bi-directional model is as follows:
U = G⊺γU + ε1,
(11)
X = Y βY →X + G⊺γX + UγX,U + ε2,
(12)
Y = XβX→Y + G⊺γY + UγY,U + ε3,
(13)
Gij ∼Binomial(2, maf j), maf j ∼U(0.1, 0.5),
(14)
where the error terms ε1, ε2, ε3 each follow an independent normal distribution with mean 0 and unit
variance. The causal effects βY →X and βX→Y are generated from a uniform distribution between
[−1, −0.5] ∪[0.5, 1]. Note that by setting βY →X = 0 in Eq.(12), the data generation process for the
one directional model can be obtained.
We here conducted experiments with the following tasks.
• T1: Sensitivity to Sample Size. We evaluated the impact of different sample sizes: n = 2k, 5k,
and 10k, where k equals 1, 000.
5For sisVIVE algorithm, we used the implementations in the R sisVIVE package, which can be downloaded
at https://cran.r-project.org/web/packages/sisVIVE/.
6For IV-TETRAD method, we used the implementations in the R package, which can be downloaded at
https://www.homepages.ucl.ac.uk/~ucgtrbd/code/iv_discovery/.
7For the TSHT algorithm, we used the implementations in the R RobustIV package, which can be down-
loaded at https://cran.r-project.org/web/packages/RobustIV/.
8

• T2: Sensitivity to the Number of Valid IVs. We explored three distinct IV combination scenar-
ios: S(2, 2, 6), S(3, 3, 8), and S(4, 4, 10). The ﬁrst two elements in the parentheses represent
the number of valid instrumental variables for causal relationships X →Y and Y →X, respec-
tively. The last element in the parentheses represents the total number of genetic variants.
For a comprehensive analysis, we examined the data from the Bi-directional MR model and the
One-directional MR model, as detailed in Section 6.1 and 6.2, respectively. For each experimental
setting, we repeated the simulation 500 times and averaged the results.
Metrics: We adopted the following evaluation metrics to evaluate the results of all methods.
• (i) Correct-Selecting Rate (CSR): the number of correctly identiﬁed valid IVs divided by the
total number of genetic variants, for the direction X →Y or Y →X.
• (ii) Mean Squared Error (MSE): The squared difference between the estimated causal effect
and the true causal effect.
To further validate the effectiveness and practicality of our algorithm, we have expanded our ex-
perimental settings to include additional scenarios such as small sample sizes, different numbers of
valid IVs, large-scale datasets, and cases where all IVs are valid. Within these settings, we com-
pare our algorithm with the ﬁve aforementioned methods to assess algorithm performance. Detailed
experimental results are provided in Appendix H.3 ∼H.6.
6.1
Evaluation on Bi-Directional MR Model
In this section, we evaluate the performance of six methods on bi-directional MR data, i.e.,
βX→Y ̸= 0 and βY →X ̸= 0. Table 1 summarizes the results of metrics CSR and MSE in a bi-
directional MR model with various sample sizes. It is noted that sisVIVE, IV-TETRAD, and TSHT
are not speciﬁcally designed for the bi-directional model, so we run them in both forward and re-
verse directions to obtain the corresponding results. As expected, our proposed PReBiM method
gives the best results in all three scenarios, with all sample sizes, indicating that it can identify valid
IVs and derive consistent causal effects from purely observational data, even without knowledge of
the causal direction between X and Y . Furthermore, the performance of the other three comparison
methods of selecting IVs was poor, indicating that they are not suitable for bi-directional MR models.
The MSE of the NAIVE method does not tend toward 0, indicating that if unobserved confounding
is not considered, the estimated causal effect is certainly biased. Similarly, the MSE of MR-Egger
is poor if estimated with all instrumental variables.
Table 1: Performance comparison of NAIVE, MR-Egger, sisVIVE, IV-TETRAD, TSHT, and PRe-
BiM in estimating bi-directional MR models across various sample sizes and three scenarios.
S(2, 2, 6)
S(3, 3, 8)
S(4, 4, 10)
X →Y
Y →X
X →Y
Y →X
X →Y
Y →X
Size
Algorithm
CSR↑
MSE↓
CSR↑
MSE↓
CSR↑
MSE↓
CSR↑
MSE↓
CSR↑
MSE↓
CSR↑
MSE↓
NAIVE
-
0.354
-
0.349
-
0.351
-
0.320
-
0.335
-
0.304
MR-Egger
-
0.800
-
0.734
-
0.571
-
0.569
-
0.457
-
0.494
2k
sisVIVE
0.30
0.398
0.25
0.447
0.34
0.379
0.32
0.379
0.37
0.346
0.38
0.330
IV-TETRAD
0.60
0.859
0.30
0.867
0.60
0.773
0.28
0.782
0.67
0.688
0.23
0.622
TSHT
0.07
0.606
0.06
0.660
0.07
0.549
0.07
0.613
0.12
0.653
0.11
0.689
PReBiM
0.85
0.046
0.85
0.070
0.89
0.083
0.87
0.075
0.88
0.039
0.89
0.057
NAIVE
-
0.350
-
0.339
-
0.347
-
0.319
-
0.357
-
0.306
MR-Egger
-
0.737
-
0.836
-
0.604
-
0.508
-
0.515
-
0.520
5k
sisVIVE
0.32
0.421
0.30
0.407
0.33
0.378
0.35
0.384
0.39
0.439
0.38
0.365
IV-TETRAD
0.62
0.804
0.31
0.844
0.63
0.836
0.29
0.659
0.67
0.686
0.25
0.640
TSHT
0.04
0.544
0.06
0.565
0.08
0.528
0.06
0.570
0.10
0.549
0.07
0.541
PReBiM
0.93
0.020
0.91
0.027
0.90
0.019
0.92
0.020
0.90
0.009
0.91
0.010
NAIVE
-
0.366
-
0.348
-
0.319
-
0.342
-
0.349
-
0.300
MR-Egger
-
0.800
-
0.763
-
0.524
-
0.620
-
0.487
-
0.424
10k
sisVIVE
0.31
0.457
0.29
0.503
0.37
0.383
0.31
0.394
0.41
0.399
0.41
0.328
IV-TETRAD
0.64
0.811
0.31
0.804
0.64
0.748
0.29
0.696
0.71
0.635
0.24
0.577
TSHT
0.04
0.449
0.02
0.475
0.05
0.525
0.05
0.466
0.05
0.479
0.07
0.498
PReBiM
0.95
0.044
0.93
0.018
0.93
0.026
0.93
0.039
0.93
0.027
0.94
0.011
Note: The symbol "−" means methods have no output. "↑" means a higher value is better, and vice versa.
6.2
Evaluation on One-Directional MR Model
In this section, we evaluate the performance of six methods on one-directional MR data, e.g.,
βX→Y ̸= 0 and βY →X = 0. For fairness, we assume that the causal direction X →Y is known
for all methods. Figure 5 summarizes the results of metrics CSR (solid lines) and MSE (dashed
9

lines) for all methods in a one-directional MR model with different scenarios. As expected, the
metrics CSR and MSE of our method approach the expected value as the sample size increases. The
overall results are comparable to the IV-TETRAD algorithm and superior to the sisVIVE algorithm
and TSHT algorithm. This is because our method, similar to the IV-TETRAD method, requires
fewer valid IVs in the system (at least 2), whereas the other two methods require the number of
valid IVs that are related to the overall genetic variants, namely the majority rule assumption (over
50% of the candidate IVs are valid) and plurality rule assumption (the number of valid IVs is larger
than any number of invalid IVs). It has been noted that under the IV-TETRAD method for scenario
S(2, 0, 6), the metrics CSR and MSE outperform our method. This is because the IV-TETRAD
method requires a predetermined number of IV sets to be speciﬁed in advance, and in this case, we
have predetermined the number of valid IVs for it. However, our method does not have this prior
information.
2k
5k
10k
Sample Sizes
0.2
0.4
0.6
0.8
1.0
CSR 
PReBiM
sisVIVE
IV-TETRAD
TSHT
0.0
0.1
0.2
0.3
0.4
0.5
MSE
(a) S(2, 0, 6)
2k
5k
10k
Sample Sizes
0.6
0.7
0.8
0.9
1.0
CSR 
0.00
0.05
0.10
0.15
0.20
0.25
0.30
MSE
(b) S(3, 0, 8)
2k
5k
10k
Sample Sizes
0.6
0.7
0.8
0.9
1.0
CSR 
0.00
0.02
0.04
0.06
0.08
0.10
MSE
(c) S(4, 0, 10)
Figure 5: Performance comparison of sisVIVE, IV-TETRAD, TSHT, and PReBiM in estimating
one-directional MR models across various sample sizes and three scenarios.
6.3
Evaluation on Real-World Data
We ﬁrst apply our method to analyze the bi-directional causal relationships between obesity and
vitamin D status using the GWAS data from Vimaleswaran et al. [2013]. Note that the original
data only consists of summary data, and thus we generate individual-level data based on the data
generation mechanism described in Eq.(1). The data we used comprises 16 related SNPs as can-
didate IVs, including seven SNPs associated with obesity (BMI): rs9939609 (FTO), rs2867125
(TMEM18), rs4074134 (BDNF), rs7647305 (ETV5), rs7138803 (FAIM2), rs3101336 (NEGR1),
and rs10938397 (GNPDA2); four SNPs related to 25-hydroxyvitamin D (25(OH)D): rs12785878
(DHCR7), rs10741657 (CYP2R1), rs2282679 (GC), and rs6013897 (CYP24A1); and ﬁve SNPs as-
sociated with BMI and 25(OH)D: rs4498364, rs1381660, rs4549702, rs12760109, and rs77913838.
We observed that FTO and FAIM2 serve as valid IVs for the X →Y , while DHCR7 and CYP24A1
are valid IVs for the Y →X, with estimated causal effects of -1.15 and -0.05, respectively. These
ﬁndings are consistent with those ﬁndings in [Vimaleswaran et al., 2013].
Next, we apply our method to analyze the causal effect of institutions on economic development
using the Colonial Origins dataset from [Acemoglu et al., 2001]. The data includes eight candidate
IVs: absolute latitude (lat_abst), the density of European settlements in 1900 (euro1900), the level
of democracy in 1900 (democ1), constitutional constraints in 1900 (cons1), the timing of industri-
alization (indtime), democracy in 2000 (democ00a), constitutional constraints in 2000 (cons00a),
and log-transformed European settler mortality rates (logem4). Our method identiﬁes euro1900 and
logem4 as valid IVs, with an estimated causal effect of 0.861, which is consistent with the ﬁndings
reported in Acemoglu et al. [2001].
7
Conclusion
We investigated the identiﬁability conditions for the bi-directional MR model using purely observa-
tional data. First, we proposed a testable constraint for identifying valid IV sets, and we demon-
strated that, under appropriate conditions, these valid IV sets can be partially or even fully identiﬁed
by checking the proposed constraints. Experimental results on both datasets further veriﬁed the ef-
fectiveness of our algorithm. Currently, we assume that genetic variants are randomized. Allowing
for general dependent genetic variants is a direction for future work. Additionally, while we focus
on a linear bi-directional MR model, in future research, we will generalize to address nonlinear or
even more complex data.
10

Acknowledgements
Feng Xie would like to acknowledge the support by the National Natural Science Foundation of
China (62306019). Yan Zeng would like to acknowledge the support of the Beijing Municipal Ed-
ucation Commission Science and Technology Program General Project (KM202410011016). Feng
Xie and Yan Zeng acknowledge the support by the funding from the Disciplinary funding of Bei-
jing Technology and Business University, the Beijing Municipal Education Commission for the
Emerging Interdisciplinary Platform for Digital Business at Beijing Technology and Business Uni-
versity, and the Beijing Key Laboratory of Applied Statistics and Digital Regulation. Zhen Yao
acknowledges the support of the Graduate Research Ability Enhancement Program Project Funding
at Beijing Technology and Business University in 2024. We appreciate the constructive comments
from all anonymous reviewers, which greatly helped to improve this paper.
References
Daron Acemoglu, Simon Johnson, and James A Robinson. The colonial origins of comparative
development: An empirical investigation. American economic review, 91(5):1369–1401, 2001.
TW Anderson. An introduction to multivariate statistical analysis. Wiley series in probability and
statistics Show all parts in this series, 2003.
Jack Bowden, George Davey Smith, and Stephen Burgess. Mendelian randomization with invalid
instruments: effect estimation and bias detection through egger regression. International journal
of epidemiology, 44(2):512–525, 2015.
Jack Bowden, George Davey Smith, Philip C Haycock, and Stephen Burgess. Consistent estimation
in mendelian randomization with some invalid instruments using a weighted median estimator.
Genetic epidemiology, 40(4):304–314, 2016.
Roger J Bowden and Darrell A Turkington. Instrumental variables. Number 8. Cambridge university
press, 1990.
Ben Brumpton, Eleanor Sanderson, Karl Heilbron, Fernando Pires Hartwig, Sean Harrison,
Gunnhild Åberge Vie, Yoonsu Cho, Laura D Howe, Amanda Hughes, Dorret I Boomsma, et al.
Avoiding dynastic, assortative mating, and population stratiﬁcation biases in mendelian random-
ization through within-family analyses. Nature communications, 11(1):3519, 2020.
Stephen Burgess, Dylan S Small, and Simon G Thompson. A review of instrumental variable esti-
mators for mendelian randomization. Statistical methods in medical research, 26(5):2333–2355,
2017.
Ruichu Cai, Feng Xie, Clark Glymour, Zhifeng Hao, and Kun Zhang. Triad constraints for learning
causal structure of latent variables. Advances in neural information processing systems, 32, 2019.
Robert Carreras-Torres, Mattias Johansson, Valerie Gaborieau, Philip C Haycock, Kaitlin H Wade,
Caroline L Relton, Richard M Martin, George Davey Smith, and Paul Brennan. The role of
obesity, type 2 diabetes, and metabolic factors in pancreatic cancer: a mendelian randomization
study. JNCI: Journal of the National Cancer Institute, 109(9), 2017.
Robert Carreras-Torres, Mattias Johansson, Philip C Haycock, Caroline L Relton, George Davey
Smith, Paul Brennan, and Richard M Martin. Role of obesity in smoking behaviour: Mendelian
randomisation study in uk biobank. bmj, 361, 2018.
Bryant Chen, Daniel Kumor, and Elias Bareinboim. Identiﬁcation and model testing in linear struc-
tural equation models using auxiliary variables. In ICML, pages 757–766, 2017.
Debo Cheng, Jiuyong Li, Lin Liu, Kui Yu, Thuc Duy Le, and Jixue Liu. Discovering ancestral
instrumental variables for causal inference from observational data. IEEE Transactions on Neural
Networks and Learning Systems, pages 1–11, 2023.
Tianjiao Chu, Richard Scheines, and Peter Spirtes. Semi-instrumental variables: a test for instru-
ment admissibility. In Proceedings of the Seventeenth conference on Uncertainty in artiﬁcial
intelligence, pages 83–90, 2001.
11

Gabriel Cuellar-Partida, Yi Lu, Pik Fang Kho, Alex W Hewitt, H-Erich Wichmann, Seyhan Yazar,
Dwight Stambolian, Joan E Bailey-Wilson, Robert Wojciechowski, Jie Jin Wang, et al. Assessing
the genetic predisposition of education on myopia: a mendelian randomization study. Genetic
epidemiology, 40(1):66–72, 2016.
Liza Darrous, Ninon Mounier, and Zoltán Kutalik. Simultaneous estimation of bi-directional causal
effects and heritable confounding from gwas summary statistics. Nature communications, 12(1):
7274, 2021.
George Davey Smith and Shah Ebrahim. mendelian randomization: can genetic epidemiology con-
tribute to understanding environmental determinants of disease? International journal of epidemi-
ology, 32(1):1–22, 2003.
Mathias Drton and Thomas S Richardson. Iterative conditional ﬁtting for gaussian ancestral graph
models. In UAI, pages 130–137. AUAI Press, 2004.
Brian A Ference, Faisal Majeed, Raju Penumetcha, John M Flack, and Robert D Brook. Effect of
naturally random allocation to lower low-density lipoprotein cholesterol on the risk of coronary
heart disease mediated by polymorphisms in npc1l1, hmgcr, or both: a 2× 2 factorial mendelian
randomization study. Journal of the American College of Cardiology, 65(15):1552–1561, 2015.
Xue Gao, Ling-Xian Meng, Kai-Li Ma, Jie Liang, Hui Wang, Qian Gao, and Tong Wang. The
bidirectional causal relationships of insomnia with ﬁve major psychiatric disorders: a mendelian
randomization study. European Psychiatry, 60:79–85, 2019.
Arthur S Goldberger. Structural equation methods in the social sciences. Econometrica: Journal of
the Econometric Society, pages 979–1001, 1972.
Zijian Guo, Hyunseung Kang, T Tony Cai, and Dylan S Small. Conﬁdence intervals for causal
effects with invalid instruments by using two-stage hard thresholding with voting. Journal of the
Royal Statistical Society: Series B (Statistical Methodology), 80(4):793–815, 2018.
Jason S Hartford, Victor Veitch, Dhanya Sridhar, and Kevin Leyton-Brown. Valid causal inference
with (some) invalid instruments. In International Conference on Machine Learning, pages 4096–
4106. PMLR, 2021.
Jerry A Hausman. Speciﬁcation and estimation of simultaneous equation models. Handbook of
econometrics, 1:391–448, 1983.
Miguel A Hernán and James M Robins.
Instruments for causal inference: an epidemiologist’s
dream? Epidemiology, pages 360–372, 2006.
Hyunseung Kang, Anru Zhang, T Tony Cai, and Dylan S Small. Instrumental variables estimation
with some invalid instruments and its application to mendelian randomization. Journal of the
American statistical Association, 111(513):132–144, 2016.
Debbie A Lawlor, Roger M Harbord, Jonathan AC Sterne, Nic Timpson, and George Davey Smith.
Mendelian randomization: using genes as instruments for making causal inferences in epidemiol-
ogy. Statistics in medicine, 27(8):1133–1163, 2008.
Gloria Hoi-Yee Li, Ching-Lung Cheung, Philip Chun-Ming Au, Kathryn Choon-Beng Tan, Ian
Chi-Kei Wong, and Pak-Chung Sham. Positive effects of low ldl-c and statins on bone mineral
density: an integrated epidemiological observation analysis and mendelian randomization study.
International Journal of Epidemiology, 49(4):1221–1235, 2020.
Sai Li and Ting Ye. A focusing framework for testing bi-directional causal effects with gwas sum-
mary data. arXiv preprint arXiv:2203.06887, 2022.
Edwin P Martens, Wiebe R Pestman, Anthonius de Boer, Svetlana V Belitser, and Olaf H Klungel.
Instrumental variables: application and limitations. Epidemiology, pages 260–267, 2006.
Lauren E Mokry, Stephanie Ross, Omar S Ahmad, Vincenzo Forgetta, George Davey Smith, Aaron
Leong, Celia MT Greenwood, George Thanassoulis, and J Brent Richards. Vitamin d and risk of
multiple sclerosis: a mendelian randomization study. PLoS medicine, 12(8):e1001866, 2015.
12

Joris M Mooij, Dominik Janzing, and Bernhard Schölkopf. From ordinary differential equations to
structural causal models: the deterministic case. arXiv preprint arXiv:1304.7920, 2013.
RC Richmond, KH Wade, Laura Corbin, Jack Bowden, Gibran Hemani, NJ Timpson, and
G Davey Smith. Investigating the role of insulin in increased adiposity: bi-directional mendelian
randomization study. BioRxiv, page 155739, 2017.
Rebecca C Richmond and George Davey Smith. Mendelian randomization: concepts and scope.
Cold Spring Harbor Perspectives in Medicine, 12(1):a040501, 2022.
Eleanor Sanderson, M Maria Glymour, Michael V Holmes, Hyunseung Kang, Jean Morrison, Mar-
cus R Munafò, Tom Palmer, C Mary Schooling, Chris Wallace, Qingyuan Zhao, et al. Mendelian
randomization. Nature Reviews Methods Primers, 2(1):6, 2022.
Ricardo Silva and Shohei Shimizu.
Learning instrumental variables with structural and non-
gaussianity assumptions. Journal of Machine Learning Research, 18(120):1–49, 2017.
Eric AW Slob and Stephen Burgess. A comparison of robust mendelian randomization methods
using summary data. Genetic epidemiology, 44(4):313–329, 2020.
Duncan C Thomas and David V Conti. Commentary: the concept of mendelian randomization.
International journal of epidemiology, 33(1):21–25, 2004.
Karani S Vimaleswaran, Diane J Berry, Chen Lu, Emmi Tikkanen, Stefan Pilz, Linda T Hiraki,
Jason D Cooper, Zari Dastani, Rui Li, Denise K Houston, et al. Causal relationship between
obesity and vitamin d status: bi-directional mendelian randomization analysis of multiple cohorts.
PLoS medicine, 10(2):e1001383, 2013.
Frank Windmeijer, Helmut Farbmacher, Neil Davies, and George Davey Smith. On the use of the
lasso for instrumental variables estimation with some invalid instruments. Journal of the American
Statistical Association, 114(527):1339–1350, 2019.
Frank Windmeijer, Xiaoran Liang, Fernando P Hartwig, and Jack Bowden. The conﬁdence interval
method for selecting valid instrumental variables. Journal of the Royal Statistical Society: Series
B (Statistical Methodology), 83(4):752–776, 2021.
Jeffrey M Wooldridge. Econometric analysis of cross section and panel data. 2010.
Philip G Wright. Tariff on animal and vegetable oils. Macmillan Company, New York, 1928.
Feng Xie, Ruichu Cai, Biwei Huang, Clark Glymour, Zhifeng Hao, and Kun Zhang. Generalized
independent noise conditionfor estimating latent variable causal graphs. In Advances in Neural
Information Processing Systems, pages 14891–14902, 2020.
Feng Xie, Yangbo He, Zhi Geng, Zhengming Chen, Ru Hou, and Kun Zhang. Testability of instru-
mental variables in linear non-gaussian acyclic causal models. Entropy, 24(4):512, 2022.
Haoran Xue and Wei Pan. Inferring causal direction between two traits in the presence of horizontal
pleiotropy with gwas summary data. PLoS genetics, 16(11):e1009105, 2020.
Haoran Xue and Wei Pan. Robust inference of bi-directional causal relationships in presence of
correlated pleiotropy with gwas summary data. PLoS genetics, 18(5):e1010205, 2022.
Guorui Zhao, Zhe Lu, Yaoyao Sun, Zhewei Kang, Xiaoyang Feng, Yundan Liao, Junyuan Sun,
Yuyanan Zhang, Yu Huang, and Weihua Yue. Dissecting the causal association between social
or physical inactivity and depression: a bidirectional two-sample mendelian randomization study.
Translational Psychiatry, 13(1):194, 2023.
13

A
More Details on MR
The basic goal of epidemiologic studies is to assess the effect of changes in exposure on outcomes.
The causal effect of exposure on outcome is often different from the observed correlation due to con-
founding factors. Correlations between exposure and outcome cannot be used as reliable evidence
for inferring causality. In contrast, Mendelian Randomization (MR) studies use genetic variants
to infer the causal effect of exposure on outcome. The idea behind MR studies is to ﬁnd a genetic
variant (or multiple genetic variants) that is associated with exposure but not with other confounders
and that does not directly affect the outcome. Such a genetic variant in principle fulﬁlls the basic as-
sumptions of instrumental variables (IVs). It is then used to assess the causal effect of the exposure
on the outcome [Thomas and Conti, 2004]. Since the assumptions of IVs cannot be fully tested and
may be violated during IVs’ selection, a number of methods have emerged to identify valid IVs.
MR studies can be conducted using a single sample, i.e., one-sample Mendelian Randomization,
in which individuals are tested for genetic variation, exposure, and outcome in the same population.
On the contrary, in two-sample Mendelian Randomization, the association between genetic vari-
ation and exposure is estimated in one dataset while that between genetic variation and outcome is
estimated in another dataset. Compared with the Two-sample MR, one-sample MR provides more
direct evidence by eliminating potential biases that can arise from individual-level data, which turns
out to be more meaningful yet challenging.
Additionally, most existing MR methods assume a one-directional causal relationship between expo-
sure and outcome, whereas bi-directional relationships are ubiquitous in real-life scenarios. For in-
stance, there exist bi-directional relationships between obesity and vitamin D status [Vimaleswaran
et al., 2013], body mass index (BMI) and type 2 diabetes (T2D), diastolic blood pressure and stroke
[Xue and Pan, 2022], insomnia and ﬁve major psychiatric disorders [Gao et al., 2019], smoking and
BMI [Carreras-Torres et al., 2018], etc. It is thus desirable to take further research on bi-directional
MR. Bi-directional Mendelian Randomization assesses not only the causal effect of the exposure
on the outcome but also the effect of the outcome on the exposure. To achieve this, valid IVs for
both the exposure and the outcome are needed. However, this is tough because genetic variants
associated with the exposure are often also associated with the outcome, and vice versa. Our goal
here is to identify and differentiate valid IVs for each direction within a one-sample MR framework
and infer bi-directional causal effects.
Regarding our bi-directional MR causal model, we give further relative descriptions in the following.
(i) Similar to Li and Ye [2022], our model in Eq.(1) describes bi-directional causality in equilib-
rium, and in econometrics, it is known as the simultaneous equation model. According to Hausman
[1983], to avoid the recursive formalization, Eq.(1) equivalently is transformed into Eq.(2) with
βX→Y βY →X ̸= 1. (ii) For such a bi-directional (cyclic) structure, Mooij et al. [2013] take an Or-
dinary Differential Equation (ODEs) perspective and show under which conditions the equilibrium
state of a system of the ﬁrst-order ODEs can be described by a deterministic structural causal model
(SCM). This is a very interesting work. Please note that our setting is different from those in Mooij
et al. [2013]: our model is motivated by bi-directional MR studies, other than a dynamical system
from the control ﬁeld. Further, due to the speciﬁcity of MR studies, we can only obtain the snapshot
data or equilibrium data, other than dynamical ones for the treatment, the outcome as well as genetic
variants.
14

B
Notation List
Table 2: List of major notations with descriptions.
NOTATION
DESCRIPTION
U
Unmeasured Confounders
G
Genetic variants
G ⊂G
Candidate genetic variants
X
Exposure or treatment
Y
Outcome
n
Sample size
γX, γY , γU
Effects of G on X, G on Y , and of G on U, respectively
∆
A reduction factor calculated with 1 −βX→Y βY →X
εX, εY
Error terms of X, and of Y , respectively
βX→Y , βY →X
True effects of X on Y , and of Y on X, respectively
ˆβX→Y , ˆβY →X
Estimated causal effects from candidate IVs for the directions X →Y and Y →X,
respectively
GX→Y
V
, GY →X
V
A set consisting of all valid IVs in G relative to X →Y , and Y →X, respectively
GX→Y
I
, GY →X
I
A set consisting at least one invalid IV in G relative to X →Y or Y →X,
respectively
TSLS(·)
The procedure of estimating causal effects using two-stage least square method
ωG
Estimated causal effect derived from G
PR(X,Y | G\Gj)
Pseudo-residual of {X, Y } relative to G\Gj
PCT
Pearson Correlation Test
C
More Details on Observations 1 and 2
C.1
Observation 1
Since GX→Y
V
= (G1, G3)⊺is a valid IV set, employing G1 or G3 in TSLS(·) entails unbiased
causal effects, i.e., ω{Gi} = TSLS(X, Y, {Gi}) = βX→Y with i ∈{1, 3}. Thus, we have,
Y −Xω{G1} = Y −XβX→Y = G2γY,2 + G4γY,4 + G5γY,5 + εY ,
Y −Xω{G3} = Y −XβX→Y = G2γY,2 + G4γY,4 + G5γY,5 + εY .
Because both G1 and G3 are valid IVs, they are independent of εY ; and any two genetic variants are
assumed to be independent of each other, we get,
corr(Y −Xω{G3}, G1) = 0,
corr(Y −Xω{G1}, G3) = 0.
C.2
Observation 2
Without loss of generality, we here give details about how corr(Y −Xω{G4,G5}, G2) ̸= 0 is derived.
The other two inequalities could be obtained in the same way. Following the procedure of TSLS(·),
we ﬁrst get the estimate of X with {G4, G5}, denoted by ˆX, and obtain ω{G4,G5} using ˆX and Y .
ˆX = G4 ˆβ4 + G5 ˆβ5
= G4(γX,4 + γY,4βY →X)∆+ G5(γX,5 + γY,5βY →X)∆
= (G4γX,4 + G4γY,4βY →X + G5γX,5 + G5γY,5βY →X)∆,
where since G4 and G5 are neither correlated with the latent confounder U nor the other IVs as
shown in Figure 2, the second equality holds. Then, we could get the estimate of ω{G4,G5}, i.e.,
ω{G4,G5} =
cov(G4, G4)(γX,4 + γY,4βY →X)(γY,4 + γX,4βX→Y )
cov(G4, G4)(γX,4 + γY,4βY →X)2 + cov(G5, G5)(γX,5 + γY,5βY →X)2
+
cov(G5, G5)(γX,5 + γY,5βY →X)(γY,5 + γX,5βX→Y )
cov(G4, G4)(γX,4 + γY,4βY →X)2 + cov(G5, G5)(γX,5 + γY,5βY →X)2 .
15

Then we get,
corr(Y −Xω{G4,G5}, G2)
= (γY,2 + γX,2βX→Y )∆−(γX,2 + γY,2βY →X)∆ω{G4,G5}
= [γX,2(βX→Y −ω{G4,G5}) + γY,2(1 −βY →Xω{G4,G5})]∆.
Since,
βX→Y −ω{G4,G5}
= βX→Y (γX,4 + γY,4βY →X)2cov(G4, G4) + βX→Y (γX,5 + γY,5βY →X)2cov(G5, G5)
(γX,4 + γY,4βY →X)2cov(G4, G4) + (γX,5 + γY,5βY →X)2cov(G5, G5)
−
(γX,4 + γY,4βY →X)(γY,4 + γX,4βX→Y )cov(G4, G4)
(γX,4 + γY,4βY →X)2cov(G4, G4) + (γX,5 + γY,5βY →X)2cov(G5, G5)
−
(γX,5 + γY,5βY →X)(γY,5 + γX,5βX→Y )cov(G5, G5)
(γX,4 + γY,4βY →X)2cov(G4, G4) + (γX,5 + γY,5βY →X)2cov(G5, G5)
= (βX→Y βY →X −1)[γY,4(γX,4 + γY,4βY →X) + γY,5(γX,5 + γY,5βY →X)]
(γX,4 + γY,4βY →X)2 + (γX,5 + γY,5βY →X)2
= (βX→Y βY →X −1)(C44ΓX,4γY,4 + C55ΓX,5γY,5)
C44Γ2
X,4 + C55Γ2
X,5
,
and
1 −βY →Xω{G4,G5}
= (γX,4 + γY,4βY →X)2cov(G4, G4) + (γX,5 + γY,5βY →X)2cov(G5, G5)
(γX,4 + γY,4βY →X)2cov(G4, G4) + (γX,5 + γY,5βY →X)2cov(G5, G5)
−
βY →X(γX,4 + γY,4βY →X)(γY,4 + γX,4βX→Y )cov(G4, G4)
(γX,4 + γY,4βY →X)2cov(G4, G4) + (γX,5 + γY,5βY →X)2cov(G5, G5)
−
βY →X(γX,5 + γY,5βY →X)(γY,5 + γX,5βX→Y )cov(G5, G5)
(γX,4 + γY,4βY →X)2cov(G4, G4) + (γX,5 + γY,5βY →X)2cov(G5, G5)
= [γX,4(γX,4 + γY,4βY →X)cov(G4, G4) + γX,5(γX,5 + γY,5βY →X)cov(G5, G5)]∆
(γX,4 + γY,4βY →X)2cov(G4, G4) + (γX,5 + γY,5βY →X)2cov(G5, G5)
= ∆(C44ΓX,4γX,4 + C55ΓX,5γX,5)
C44Γ2
X,4 + C44Γ2
X,5
,
Where we deﬁne ΓX,i = γX,i + γY,iβY →X, ΓY,j = γY,j + γX,jβX→Y , Cij = cov(Gi, Gj) and
∆≜1 −βY →XβX→Y . we can ﬁnally obtain corr(Y −Xω{G4,G5}, G2), that is,
corr(Y −Xω{G4,G5}, G2)
= γX,2(βX→Y βY →X −1)(C44ΓX,4γY,4 + C55ΓX,5γY,5)∆
C44Γ2
X,4 + C55Γ2
X,5
+ γY,2(1 −βY →XβX→Y )(C44ΓX,4γX,4 + C55ΓX,5γX,5)∆
C44Γ2
X,4 + C55Γ2
X,5
= C44ΓX,4(γX,2γY,4 −γX,4γY,2) + C55ΓX,5(γX,2γY,5 −γX,5γY,2)
C44Γ2
X,4 + C55Γ2
X,5
̸= 0.
D
More Details on the Example Provided in Section 5
Figure 6 gives an illustration of our idea, demonstrating that even when IVs are correlated, we can
still identify them as valid IVs using our proposed method. In subgraph (a), there are two valid IVs:
G1 and G2. However, in subgraph (b), these two IVs become invalid as G1 is correlated with Y ,
rendering them invalid.
16

U
G2
G1
X
Y
(a)
U
G2
G1
X
Y
(b)
Figure 6: A simple example, where the set {G1, G2} is a valid IV set in subgraph (a), whereas it is
not valid in subgraph (b).
Assume the generating process of X and Y in subgraph (a) follows:
X = Y βY →X + G1γX,1 + G2γX,2 + εX,
Y = XβX→Y + εY ,
G2 = G1γ1,2 + ε2.
(15)
where εX and εY are correlated, and ε2 represents the independent error term.
For G1 ∈G, we check the condition of Proposition 3:
ω{G1} = TSLS(X, Y, {G1}) = cov(Y, G1)
cov(X, G1) = βX→Y + cov(εY , G1)
cov(X, G1) = βX→Y
PR(X,Y | {G1}) = Y −ω{G1}X = εY
corr(PR(X,Y | {G1}), G2) = 0
Similarly, for G2 ∈G, we check the condition of Proposition 3:
ω{G2} = TSLS(X, Y, {G2}) = cov(Y, G2)
cov(X, G2) = βX→Y + cov(εY , G2)
cov(X, G2) = βX→Y
PR(X,Y | {G2}) = Y −ω{G2}X = εY
corr(PR(X,Y | {G2}), G1) = 0
Assume the generating process of X and Y in subgraph (b) follows Equation 16:
X = Y βY →X + G1γX,1 + G2γX,2 + εX,
Y = XβX→Y + G1γY,1 + εY ,
G2 = G1γ1,2 + ε2.
(16)
where εX and εY are correlated, and ε2 represents the independent error term.
Then, Equation 16 can be reorganized to avoid recursive formulations as follows:
X = ∆(G1(γX,1 + γ1,2γX,2 + γY,1βY →X) + ε2γX,2 + εX + εY βY →X)
= ∆(G1ΓX,1 + ε2γX,2 + εX + εY βY →X)
Y = ∆(G1(γY,1 + βX→Y (γX,1 + γX,2γ1,2)) + ε2γX,2βX→Y + εXβX→Y + εY )
= ∆(G1ΓY,1 + ε2γX,2βX→Y + εXβX→Y + εY )
(17)
where ΓX,1 = γX,1 + γ1,2γX,2 + γY,1βY →X and ΓY,1 = γY,1 + βX→Y (γX,1 + γX,2γ1,2). It is
noted that ΓX,1 ̸= 0 and ΓY,1 ̸= 0.
In subgraph (b), for G2 ∈G, we check the condition of Proposition 3:
17

ω{G2} = TSLS(X, Y, {G2}) = cov(Y, G2)
cov(X, G2) = βX→Y + γY,1
cov(G1, G2)
cov(X, G2)
= βX→Y + γY,1γ1,2
∆
cov(G1, G1)
cov(G1, G1)(γ1,2ΓX,1) + cov(ε2, ε2)γX,2
= βX→Y + γY,1γ1,2
∆
1
γ1,2ΓX,1 + γX,2M,
PR(X,Y | {G2}) = Y −ω{G2}X
= G1γY,1 + εY −γY,1γ1,2
∆
1
γ1,2ΓX,1 + γX,2MX
= G1γY,1 + εY −γY,1γ1,2(G1ΓX,1 + ε2γX,2 + εX + εY βY →X)
γ1,2ΓX,1 + γX,2M
,
corr(PR(X,Y | {G2}), G1) = γY,1 −
γY,1γ1,2ΓX,1
γ1,2ΓX,1 + γX,2M
= γY,1γ1,2ΓX,1 + γY,1γX,2M −γY,1γ1,2ΓX,1
γ1,2ΓX,1 + γX,2M
=
γY,1γX,2M
γ1,2ΓX,1 + γX,2M
(18)
where M =
cov(ε2,ε2)
cov(G1,G1) ̸= 0.
Based on these two observations, we can conclude that the two IVs in subgraph (a) can be deemed
valid. However, in subgraph (b), they can be deemed invalid.
18

E
More Details on FindValidIVSets Algorithm (in Section 4.1)
It is noteworthy that, to mitigate the unreliability of statistical tests in ﬁnite samples, in practice,
we choose to take the smallest correlation coefﬁcient to select a valid IV set, as in Line 4 or 10 of
Algorithm 4.
Algorithm 4 FindValidIVSets
Input: A dataset of measured genetic variants G = (G1, ..., Gg)⊺, two phenotypes X and Y ,
signiﬁcance level α, and parameter W, maximum number of IVs to consider.
1: Initialize valid IV sets V = ∅and ˜G = G.
2: repeat
3:
For all subsets G ∈˜G with |G| = 2, compute the correlation between pseudo-residual
PR(X,Y | G\Gi) and Gi, where Gi ∈G.
4:
Vnew ←arg min
G∈G
2P
i=1
corr(PR(X,Y | G\Gi), Gi).
5:
repeat
6:
˜G′ ←˜G
7:
For each variable Gk ∈˜G′, remove all variables from ˜G′ corresponding to those that set
{V, Gk} fail to the PCT.
8:
if ˜G′ ̸= ∅then
9:
Compute the correlation between pseudo-residual PR(X,Y | V) and Gk.
10:
G′ ←arg min
Gk∈˜G′
corr(PR(X,Y | V), Gk).
11:
Vnew ←Vnew ∪{Gk}.
12:
else
13:
Break the loop of line 5;
14:
end if
15:
until the length of the set Vnew has reached our predeﬁned threshold W.
16:
if Set V = ∅then
17:
Add set Vnew into V.
18:
else
19:
if Set {V ∪Vnew} fail to PCT then
20:
Add set Vnew into V.
21:
else
22:
Delete set Vnew from ˜G.
23:
end if
24:
end if
25: until V contains two sets or | ˜G| ≤1.
Output: V, a set that collects the valid IV sets.
19

F
More Details on InferCausalDirectionEffects Algorithm (in Section 4.2)
Algorithm 5 InferCausalDirectionEffects
Input: Two phenotypes X and Y , Valid IV sets V.
1: Initialize sets GX→Y
V
= ∅and GY →X
V
= ∅, and the causal effects ˆβX→Y = ∅and ˆβY →X = ∅.
2: for each Gj ∈V do
3:
if |corr(Gj, Y )/corr(Gj, X)| < 1 then
4:
Add Gj into GX→Y
V
;
5:
else
6:
Add Gj into GY →X
V
;
7:
end if
8: end for
9: ˆβX→Y ←TSLS(X, Y, GX→Y
V
).
10: ˆβY →X ←TSLS(Y, X, GY →X
V
).
Output: ˆβX→Y and ˆβY →X
G
Proofs
G.1
Proof of Proposition 1
Proof. From procedure "two-stage least squares", we obtained the ﬁtted values
ˆX from the
regression in the ﬁrst stage: ˆX = (GX→Y
V
)⊺ˆα. According to OLS regression,
ˆX = (GX→Y
V
)⊺
(GX→Y
V
(GX→Y
V
)⊺)−1GX→Y
V
X

=

(GX→Y
V
)⊺(GX→Y
V
(GX→Y
V
)⊺)−1GX→Y
V

X
= PX.
Then run the OLS regression for Y on ˆX in second stage: Y = ˆβ ˆX. where:
ˆβ = ( ˆX⊺ˆX)−1( ˆX⊺Y )
= ((PX)⊺PX)−1((PX)⊺Y )
= (X⊺PX)−1(X⊺PY )
= (X⊺PX)−1(X⊺P)
 XβX→Y + (GX→Y
V
)⊺γY + εY

= βX→Y + (X⊺PX)−1(X⊺P(GX→Y
V
)⊺γY ) + (X⊺PX)−1(X⊺PεY )
Since GX→Y
V
is a valid IV set, for Gj ∈GX→Y
V
, both γY,j = 0 (A2) and cov(Gj, εY ) = 0 (A3).
Hence, we obtained
(X⊺PX)−1(X⊺P(GX→Y
V
)⊺γY ) = 0
(X⊺PX)−1(X⊺PεY ) = (X⊺PX)−1(X⊺(GX→Y
V
)⊺(GX→Y
V
(GX→Y
V
)⊺)−1GX→Y
V
εY = 0,
which implies that ˆβ = βX→Y .
G.2
Proof of Remark 1
Proof. Similar to G.1, from procedure "two-stage least squares", we obtained the ﬁtted values ˆX
from the regression in the ﬁrst stage: ˆX = (GX→Y
I
)⊺ˆα. According to OLS regression,
ˆX = (GX→Y
I
)⊺
(GX→Y
I
(GX→Y
I
)⊺)−1GX→Y
I
X

=

(GX→Y
I
)⊺(GX→Y
I
(GX→Y
I
)⊺)−1GX→Y
I

X
= ˜PX.
20

Then run the OLS regression for Y on ˆX in second stage: Y = ˆβ ˆX. where:
ˆβ = ( ˆX⊺ˆX)−1( ˆX⊺Y )
= ((˜PX)⊺˜PX)−1((˜PX)⊺Y )
= (X⊺˜PX)−1(X⊺˜PY )
= (X⊺˜PX)−1(X⊺˜P)
 XβX→Y + (GX→Y
I
)⊺γY + εY

= βX→Y +
h
X⊺˜PX
i−1
X⊺˜P(GX→Y
I
)⊺γY + εY )
|
{z
}
βbias
= βX→Y + (X⊺˜PX)−1(X⊺˜P(GX→Y
I
)⊺γY ) + (X⊺˜PX)−1(X⊺˜PεY )
Since GX→Y
I
is a valid IV set, for each Gj ∈GX→Y
I
, either γY,j ̸= 0 (A2), or cov(Gj, εY ) ̸= 0
(A3), or both γY,j ̸= 0 and cov(Gj, εY ) ̸= 0 (A2 and A3).
Hence, we obtained
(X⊺˜PX)−1(X⊺˜P(GX→Y
I
)⊺γY ) ̸= 0
(X⊺˜PX)−1(X⊺˜PεY ) = (X⊺˜PX)−1(X⊺(GX→Y
I
)⊺(GX→Y
I
(GX→Y
I
)⊺)−1GX→Y
I
εY ̸= 0,
which implies that βbias ̸= 0. That is to say the estimated causal effect ˆβ = βX→Y + βbias is
biased.
G.3
Proof of Proposition 2
Proof. We prove it by contradiction, i.e., if G is a valid IV set for one of the causal relationships,
then for each Gj ∈G, corr(PR(X,Y | G\Gj), Gj) = 0. Without loss of generality, we consider the
case for X →Y . The proof with the inverse causal relationship can be derived accordingly.
i) assume that G is the valid IV set relative to the causal relationship X →Y , i.e., G ⊆GX→Y
V
.
Let Gj be a genetic variant in G. We can see that G\Gj is also a valid IV set. Because the size of
participants n →∞, and according to the consistent estimator of TSLS, we have
ω{G\Gj} = TSLS(X, Y, G\Gj) = βX→Y .
Based on Eq.(1), we have
PR(X,Y | G\Gj) = Y −Xω{G\Gj} = G⊺γY + εY
Because G is a valid IV set relative to X →Y , for Gk ∈G, k ̸= j, either γY,k = 0 (if Gk ∈G)
or corr(Gk, Gj) = 0 (if Gk /∈G). It is noted that Gk can not be correlated with Gj, otherwise, the
genetic variant Gj will dissatisfy A2 or A3. Hence, we obtain corr(G⊺γY + εY , Gj) = 0, which
implies that corr(PR(X,Y | G\Gj), Gj) = 0.
ii) assume that G is the valid IV set relative to Y →X, i.e., G ⊆GY →X
V
. Let Gj be a genetic
variant in G. We can see that G\Gj is also a valid IV set relative to Y →X. It is noted that we here
still need to verify Eq.(5). According to the TSLS estimator and Eq.(1), we have
ω{G\Gj} = TSLS(X, Y, G\Gj)
=
h
X⊺˜PX
i−1
X⊺˜PY
=
h
X⊺˜PX
i−1
X⊺˜P(1/βY →X)(X −G⊺γX −εX)
= (1/βY →X)

1 −
h
X⊺˜PX
i−1
X⊺˜P(G⊺γX + εX)

,
=

1 −
h
X⊺˜PX
i−1
X⊺˜P(G⊺γX + εX)

β−1
Y →X,
where ˜P = {G\Gj} [{G\Gj}⊺{G\Gj}]−1 {G\Gj}⊺, X, Y and εX are n × 1 vectors, G is n × p
matrix and γX is a g × 1 vector.
21

Hence, we have
PR(X,Y | G\Gj) = Y −Xω{G\Gj}
= Y −X

1 −
h
X⊺˜PX
i−1
X⊺˜P(G⊺γX + εX)

β−1
Y →X
= Y −Xβ−1
Y →X + X
h
X⊺˜PX
i−1
X⊺˜P(G⊺γX + εX)β−1
Y →X
= −(G⊺γX + εX)β−1
Y →X + X
h
X⊺˜PX
i−1
X⊺˜P(G⊺γX + εX)β−1
Y →X
=

−I + X
h
X⊺˜PX
i−1
X⊺˜P

(G⊺γX + εX) β−1
Y →X,
where I is a n × n identity matrix.
Because G is a valid IV set relative to Y →X, for Gk ∈G, k ̸= j, either γX,k = 0 (if Gk ∈G) or
corr(Gk, Gj) = 0 (if Gk /∈G).
Hence,
corr(G⊺γX + εX), Gj) = 0
Therefore, we obtain
corr((X/βY →X)
h
X⊺˜PX
i−1
X⊺˜P(G⊺γX + εX), Gj) = 0
which implies that corr(PR(X,Y | G\Gj), Gj) = 0.
G.4
Proof of Proposition 3
Proof. We prove it by contradiction, i.e., if G is an invalid IV set for one of the causal relationships,
then there exists at least one Gj ∈G such that corr(PR(X,Y | G\Gj), Gj) ̸= 0. Without loss of
generality, we consider the case for X →Y . The proof with the inverse causal relationship Y →X
can be derived accordingly. There are three cases to be considered. i) Suppose Gj is an invalid IV
in G and G\Gj is a valid IV set; ii) Suppose Gj is an invalid IV in G and G\Gj is an invalid IV set;
iii) Suppose Gj is a valid IV in G and G\Gj is an invalid IV set.
i) Suppose Gj is invalid and all IVs in G\Gj are valid. Due to the validity of all IVs in G\Gj,
according to the consistent estimator of TSLS, we have,
ω{G\Gj} = TSLS(X, Y, G\Gj) = βX→Y .
In order to consider the case of all violating assumptions for IVs, we extend Eq.(1) to Eq.(6), we
have
PR(X,Y | G\Gj) = Y −Xω{G\Gj} = G⊺γY + εY = G⊺γY + UγY,U + ε3,
where we make εY = UγY,U + ε3 to tell the inﬂuential difference between the latent confounder U
and the external noise ε2 on Y . Here Gj ⊥⊥ε3 but Gj may be correlated with U by γU,j. Denote by
Gi the other IV with i ̸= j, and we have Gj ⊥⊥Gi. Hence,
corr(PR(X,Y | G\Gj, Gj)
= γY,jcov(Gj, Gj) + γY,UγU,jcov(Gj, Gj)
q
V ar(PR(X,Y | G\Gj)
p
V ar(Gj)
=
(γY,j + γY,UγU,j)cov(Gj, Gj)
q
V ar(PR(X,Y | G\Gj)
p
V ar(Gj)
.
Due to the faithfulness assumption, corr(PR(X,Y | G\Gj, Gj) ̸= 0.
ii) Suppose Gj is invalid and G\Gj is an invalid IV set, where there are m genetics in G\Gj =
{G1, ..., Gm}. Following the procedure of TSLS, we ﬁrst get the estimate of X with G\Gj, denoted
22

by ˆX, and obtain ω{G\Gj} using ˆX and Y .
ˆX =
m
X
k=1
Gk ˆβk =
m
X
k=1
Gk∆[(γX,k + γY,kβY →X) + (γX,U + γY,UβY →X)γU,k].
ω{G\Gj} =
Pm
k=1[ˆβk(γY,k + γX,kβX→Y ) + ˆβkγU,k(γY,U + γX,UβX→Y )]Ckk∆
Pm
k=1(ˆβk)2
=
Pm
k=1[¯βk(γY,k + γX,kβX→Y ) + ¯βkγU,k(γY,U + γX,UβX→Y )]Ckk
Pm
k=1(¯βm)2
,
=
Pm
k=1 ¯βk[(γY,k + γX,kβX→Y ) + γU,k(γY,U + γX,UβX→Y )]Ckk
Pm
k=1(¯βk)2
=
Pm
k=1(AX,k + AX,UγU,k)(AY,k + AY,UγU,k)Ckk
Pm
k=1(¯βk)2
,
where ¯βk = ˆβk/∆= (γX,k + γY,kβY →X) + γU,k(γX,U + γY,UβY →X) = AX,k + AX,UγU,k,
AX,k = γX,k + γY,kβY →X and AX,U = γX,U + γY,UβY →X. AY,k = γY,k + γX,kβX→Y and
AY,U = γY,U + γX,UβX→Y and Ckk = cov(Gk, Gk). Note that such notations A· enjoy some
great properties shown as below,
AX,k −AY,kβY →X = γX,k(1 −βX→Y βY →X),
AX,kβX→Y −AY,k = γY,k(βX→Y βY →X −1),
AX,1AY,2 −AX,2AY,1 = (1 −βX→Y βY →X)(γX,1γY,2 −γX,2γY,1).
(19)
Hence,
corr(PR(X,Y | G\Gj), Gj)
=
cov(Gj, Gj)
q
V ar(PR(X,Y | G\Gj)
p
V ar(Gj)
{(γY,j + γX,jβX→Y )∆−(γX,j + γY,jβY →X)∆ω{G\Gj}
+ γU,j(γY,U + γX,UβX→Y )∆−γU,j(γX,U + γY,UβY →X)∆ω{G\Gj}}
=
cov(Gj, Gj)∆
q
V ar(PR(X,Y | G\Gj)
p
V ar(Gj)
{[γY,j(1 −βY →Xω{G\Gj}) + γX,j(βX→Y −ω{G\Gj})]
+ γU,j[γY,U(1 −βY →Xω{G\Gj}) + γX,U(βX→Y −ω{G\Gj})]}
= δ∆[(1 −βY →Xω{G\Gj})(γY,j + γY,UγU,j) + (βX→Y −ω{G\Gj})(γX,j + γX,UγU,j)],
where δ =
√
V ar(Gj)
√
V ar(PR(X,Y | G\Gj ) ̸= 0. Employing the properties in Eqs.(19), we get
1 −βY →Xω{G\Gj}
=
Pm
k=1(AX,k + AX,UγU,k)2Ckk −βY →X(AX,k + AX,UγU,k)(AY,k + AY,UγU,k)Ckk
Pm
k=1(¯βk)2Ckk
= (1 −βX→Y βY →X) Pm
k=1(AX,k + AX,UγU,k)(γX,k + γX,UγU,k)Ckk
Pm
k=1(¯βk)2Ckk
,
and
βX→Y −ω{G\Gj}
= βX→Y
Pm
k=1(AX,k + AX,UγU,k)2Ckk −Pm
k=1(AX,k + AX,UγU,k)(AY,k + AY,UγU,k)Ckk
Pm
k=1(¯βk)2Ckk
= (βX→Y βY →X −1) Pm
k=1(AX,k + AX,UγU,k)(γY,k + γY,UγU,k)Ckk
Pm
k=1(¯βk)2Ckk
.
23

Thus,
corr(PR(X,Y | G\Gj), Gj)
= δ{
Pm
k=1 Ckk(AX,k + AX,UγU,k)(γX,k + γX,UγU,k)
Pm
k=1(¯βk)2Ckk
(γY,j + γY,UγU,j)
−
Pm
k=1 Ckk(AX,k + AX,UγU,k)(γY,k + γY,UγU,k)
Pm
k=1(¯βk)2Ckk
(γX,j + γX,UγU,j)}
= δ
Pm
k=1 ¯βkCkk[(γX,k + γX,UγU,k)(γY,j + γY,UγU,j) −(γY,k + γY,UγU,k)(γX,j + γX,UγU,j)]
Pm
k=1(¯βk)2Ckk
= δ
∑m
k=1 ¯βkCkk[(γX,kγY,j−γY,kγX,j)+γY,U (γX,kγU,j−γU,kγX,j)+γX,U (γU,kγY,j−γY,kγU,j)]
Pm
k=1(¯βk)2Ckk
̸= 0.
Because of the faithfulness assumption, ¯βk ̸= 0. Due to Assumption 2, for Gk ∈G\Gj and the
confounder U, Pm
k=1 ¯βkCkk[(γX,kγY,j−γY,kγX,j)+γY,U(γX,kγU,j−γU,kγX,j)+γX,U(γU,kγY,j−
γY,kγU,j)] ̸= 0.
iii) Suppose Gj is a valid IV in G and G\Gj is an invalid IV set. Similar to ii), we get ω{G\Gj}:
ω{G\Gj} =
Pm
k=1(AX,k + AX,UγU,k)(AY,k + AY,UγU,k)Ckk
Pm
k=1(¯βk)2Ckk
.
Since the valid IV Gj is uncorrelated with neither other invalid IVs nor the confounder, we then
derive,
corr(PR(X,Y | G\Gj), Gj)
= cov(Gj, Gj)∆[(γY,j + γX,jβX→Y ) −(γX,j + γY,jβY →X)∆ω{G\Gj}
q
V ar(PR(X,Y | G\Gj)
p
V ar(Gj)
= δ∆γX,j(βX→Y −ω{G\Gj}).
where:
βX→Y −ω{G\Gj}
= βX→Y
Pm
k=1 Ckk[(AX,k + AX,UγU,k)2 −(AX,k + AX,UγU,k)(AY,k + AY,UγU,k)]
Pm
k=1(¯βk)2Ckk
= (βX→Y βY →X −1) Pm
k=1 Ckk(AX,k + AX,UγU,k)(γY,k + γY,UγU,k)
Pm
k=1(¯βk)2Ckk
.
Thus, we get
corr(PR(X,Y | G\Gj), Gj) = δ∆γX,j(βX→Y −ω{G\Gj})
= −δ
Pm
k=1 Ckk(AX,k + AX,UγU,k)(γY,k + γY,UγU,k)γX,j
Pm
k=1(¯βk)2Ckk
= −δ
Pm
k=1 ¯βkCkk(γY,k + γY,UγU,k)γX,j
Pm
k=1(¯βk)2Ckk
.
Since Gj is a valid IV (γY,j = γU,j = 0), and from Assumption 2, we have Pm
k=1 ¯βkCkk(γY,k +
γY,UγU,k)γX,j ̸= 0. Proposition 3 is proved.
G.5
Proof of Proposition 4
Proof. We prove this proposition by contradiction, i.e., i) if G is the valid IV set relative to the
causal relationship Y →X, then ∃Gj ∈G satisﬁes | corr(Gj,Y )
corr(Gj,X)| ≥1; and ii) if G is the valid IV set
relative to the causal relationship X →Y , then ∃Gj ∈G satisﬁes | corr(Gj,Y )
corr(Gj,X)| < 1.
24

i) Suppose G is the valid IV set relative to the causal relationship Y →X. According to Assumption
3, we have |βY →X| ≤
q
Var(X)
Var(Y ) . Hence,

corr(Gj, Y )
corr(Gj, X)
 =

Cov(Gj, Y )
p
Var(Gj)Var(Y )
p
Var(Gj)Var(X)
Cov(Gj, X)

=

γY,j∆
p
Var(Y )
p
Var(X)
γY,j∆βY →X

=

1
βY →X
s
Var(X)
Var(Y )
 ≥1,
which proves case i).
ii) Suppose G is the valid IV set relative to the causal relationship X →Y . According to Assump-
tion 3, we have |βX→Y | <
q
Var(Y )
Var(X). Hence,

corr(Gj, Y )
corr(Gj, X)
 =

Cov(Gj, Y )
p
Var(Gj)Var(Y )
p
Var(Gj)Var(X)
Cov(Gj, X)

=

γX,j∆βX→Y
p
Var(Y )
p
Var(X)
γX,j∆

=
βX→Y
s
Var(X)
Var(Y )
 < 1,
which proves case ii) and concludes the proposition.
G.6
Proof of Theorem 1
Proof. Firstly, given Assumptions 1 and 2, in light of Propositions 2 and 3, we can identify all sets
of valid instrumental variables (IVs). Next, given Assumption 3, by Proposition 4, we can further
identify what the causal relationships corresponding to these IV sets. It is important to note that
if all the IV sets correspond to a single causal relationship, such as X →Y , we can conclude
that the model is a one-directional MR model. Finally, with the corresponding IV set identiﬁed for
each causal inﬂuence, we can employ the classical IV estimator, namely the two-stage least squares
(TSLS) estimator, to accurately estimate the causal effects.
Based on the above analysis, we can conclude that the bi-directional MR model is fully identiﬁable.
G.7
Proof of Theorem 2
Proof. The correctness of PReBiM originates from the following observations:
• Firstly, in Step 1 (Algorithm 4), by Propositions 2 and 3, valid IV sets in G have been
exactly discovered in V (Lines 2 ∼25 of Algorithm 4).
• Secondly, in Step 2 (Algorithm 5), by the condition of Proposition 4, the direction of causal
inﬂuence can be determined (Line 2 ∼8 of Algorithm 5).
• Lastly, by Eq.(1) of Proposition 1, unbiased causal effects can be estimated exactly given
the identiﬁed IV sets (Lines 9 ∼10 of Algorithm 5).
Based on the above analysis, we can identify all valid IV sets and obtain the causal effects correctly.
25

H
More Experimental Results
H.1
Evaluating the Performance on Bi-directional MR Model with Dependent Valid IVs
Table 3 summarizes the CSR and MSE metrics’ results across six methods within a bi-directional
MR model with varying sample sizes. As expected, our proposed method exhibits superior per-
formance, even in scenarios where the included valid instrumental variables (IVs) are correlated.
This highlights its capability to accurately identify effective IVs and provide consistent causal effect
estimates solely from observational data, regardless of whether the relevant IVs are correlated. Im-
portantly, this effectiveness persists without prior knowledge of the causal direction between X and
Y . Conversely, the performance of the other three methods remains suboptimal in such contexts,
indicating their limited applicability in cases with correlated valid IVs.
Table 3: Performance comparison of NAIVE, MR-Egger, sisVIVE, IV-TETRAD, TSHT, and PRe-
BiM in estimating bi-directional MR models across various sample sizes and three scenarios.
S(2, 2, 6)
S(3, 3, 8)
S(4, 4, 10)
X →Y
Y →X
X →Y
Y →X
X →Y
Y →X
Size
Algorithm
CSR↑
MSE↓
CSR↑
MSE↓
CSR↑
MSE↓
CSR↑
MSE↓
CSR↑
MSE↓
CSR↑
MSE↓
2k
NAIVE
-
0.409
-
0.341
-
0.350
-
0.372
-
0.409
-
0.314
MR-Egger
-
1.198
-
1.320
-
1.033
-
1.322
-
1.087
-
1.391
sisVIVE
0.31
0.478
0.29
0.395
0.34
0.408
0.34
0.388
0.35
0.450
0.36
0.328
IV-TETRAD
0.40
1.224
0.42
0.900
0.52
0.830
0.29
0.903
0.44
1.033
0.32
0.779
TSHT
0.09
0.657
0.04
0.636
0.10
0.696
0.08
0.699
0.12
0.804
0.10
0.708
PReBiM
0.84
0.014
0.79
0.167
0.89
0.058
0.88
0.097
0.84
0.053
0.83
0.079
5k
NAIVE
-
0.399
-
0.326
-
0.371
-
0.362
-
0.391
-
0.333
MR-Egger
-
1.000
-
1.204
-
1.171
-
1.181
-
0.971
-
1.358
sisVIVE
0.30
0.484
0.31
0.426
0.35
0.452
0.34
0.381
0.38
0.375
0.37
0.327
IV-TETRAD
0.50
1.042
0.40
0.700
0.49
1.041
0.38
0.778
0.47
0.977
0.36
0.778
TSHT
0.06
0.701
0.05
0.531
0.09
0.689
0.06
0.660
0.11
0.653
0.09
0.589
PReBiM
0.90
0.113
0.84
0.081
0.91
0.050
0.90
0.061
0.88
0.048
0.89
0.061
10k
NAIVE
-
0.378
-
0.358
-
0.408
-
0.323
-
0.401
-
0.339
MR-Egger
-
1.052
-
1.307
-
1.017
-
1.313
-
1.185
-
1.303
sisVIVE
0.33
0.465
0.34
0.427
0.35
0.448
0.34
0.358
0.38
0.431
0.41
0.299
IV-TETRAD
0.54
0.995
0.39
0.839
0.52
1.092
0.41
0.637
0.51
0.963
0.38
0.553
TSHT
0.04
0.641
0.03
0.543
0.04
0.734
0.04
0.449
0.09
0.654
0.07
0.567
PReBiM
0.90
0.058
0.87
0.089
0.94
0.018
0.93
0.026
0.93
0.022
0.92
0.056
Note: This scenario represents a bi-directional model with correlated valid IVs. The symbol "−" means
that methods do not output information. "↑" means a higher value is better, and vice versa.
H.2
Evaluating the Performance on One-directional MR Model with Dependent Valid IVs
In this section, we assess the efﬁcacy of four methods within a one-directional Mendelian Random-
ization (MR) framework. For a fair comparison, we operate under the assumption that the causal
pathway from X to Y is established for all methods. Figure 7 displays the CSR and MSE metrics for
these methods, considering diverse sample sizes and numbers of valid instrumental variables (IVs).
As expected, our approach maintains strong performance, even amidst correlated valid IVs. The
outcomes are comparable with those of the TSHT algorithm, with our method notably surpassing
both the sisVIVE and IV-TETRAD algorithms under various conditions.
2k
5k
10k
Sample Sizes
0.0
0.2
0.4
0.6
0.8
1.0
CSR 
PReBiM
sisVIVE
IV-TETRAD
TSHT
0.00
0.25
0.50
0.75
1.00
1.25
1.50
MSE
(a) S(2, 0, 6)
2k
5k
10k
Sample Sizes
0.0
0.2
0.4
0.6
0.8
1.0
CSR 
0.0
0.1
0.2
0.3
0.4
0.5
MSE
(b) S(3, 0, 8)
2k
5k
10k
Sample Sizes
0.0
0.2
0.4
0.6
0.8
1.0
CSR 
0.00
0.05
0.10
0.15
0.20
0.25
0.30
MSE
(c) S(4, 0, 10)
Figure 7: Performance comparison of sisVIVE, IV-TETRAD, TSHT, and PReBiM in estimating
one-directional MR models incorporating valid IVs across various sample sizes and three scenarios.
H.3
Evaluating the Performance on Bi-directional MR Model with Small Sample Sizes
In this section, we will evaluate the performance of these six methods in a bi-directional Mendelian
randomization framework with small samples. Table 4 displays the CSR and MSE metrics for
26

these methods, considering three scenarios with a sample size of 200. We ﬁnd that though the
performances of all four methods are not satisfactory, ours still outperforms other baselines. It also
reﬂects an open problem of our work with small sample sizes. We leave it as our future in-depth
direction.
Table 4: Performance comparison of NAIVE, MR-Egger, sisVIVE, IV-TETRAD, TSHT, and PRe-
BiM in estimating bi-directional MR models across small sample size (200) and three scenarios.
S(2, 2, 6)
S(3, 3, 8)
S(4, 4, 10)
X →Y
Y →X
X →Y
Y →X
X →Y
Y →X
Size
Algorithm
CSR↑
MSE↓
CSR↑
MSE↓
CSR↑
MSE↓
CSR↑
MSE↓
CSR↑
MSE↓
CSR↑
MSE↓
NAIVE
-
0.360
-
0.330
-
0.343
-
0.331
-
0.320
-
0.336
MR-Egger
-
0.941
-
0.657
-
0.579
-
0.594
-
0.433
-
0.535
200
sisVIVE
0.21
0.389
0.24
0.383
0.29
0.331
0.28
0.336
0.34
0.318
0.30
0.329
IV-TETRAD
0.30
1.057
0.26
0.797
0.26
0.811
0.20
0.886
0.15
0.723
0.12
0.787
TSHT
0.17
0.677
0.16
0.642
0.22
0.504
0.24
0.534
0.26
0.493
0.23
0.452
PReBiM
0.54
0.339
0.55
0.350
0.55
0.313
0.57
0.281
0.51
0.270
0.52
0.288
Note: The symbol "−" means that methods do not output this information. "↑" means a higher value is
better, and vice versa.
H.4
Evaluating the Performance on Bi-directional MR Model with Different Numbers of
Valid IVs
Table 5 summarizes the CSR and MSE metrics’ results across six methods within a bi-directional
MR model with different numbers of valid IVs. Speciﬁcally, S(2, 3, 7) indicates that in the bi-
directional model, there are two valid instrumental variables estimated for the direction X →Y ,
and three valid instrumental variables estimated for the direction Y →X, with the remaining two
being invalid instrumental variables. The same interpretation applies to S(2, 4, 8) and S(3, 5, 10).
It can be seen that whether the number of valid IVs in these two directions is the same or not does
not affect the performance of our algorithm theoretically. The experimental results also empirically
verify it. Overall, In cases where the number of IVs in both the X →Y and Y →X directions are
different, our PReBiM algorithm outperforms other baselines in terms of CSR and MSE.
Table 5: Performance comparison of NAIVE, MR-Egger, sisVIVE, IV-TETRAD, TSHT, and PRe-
BiM in estimating bi-directional MR models across various sample sizes and three scenarios.
S(2, 3, 7)
S(2, 4, 8)
S(3, 5, 10)
X →Y
Y →X
X →Y
Y →X
X →Y
Y →X
Size
Algorithm
CSR↑
MSE↓
CSR↑
MSE↓
CSR↑
MSE↓
CSR↑
MSE↓
CSR↑
MSE↓
CSR↑
MSE↓
NAIVE
-
0.433
-
0.267
-
0.464
-
0.227
-
0.431
-
0.237
MR-Egger
-
0.702
-
0.646
-
0.560
-
0.610
-
0.465
-
0.476
2k
sisVIVE
0.16
0.746
0.52
0.170
0.11
0.958
0.68
0.093
0.14
0.907
0.65
0.099
IV-TETRAD
0.37
1.490
0.55
0.368
0.24
1.886
0.71
0.188
0.35
1.474
0.56
0.150
TSHT
0.00
2.226
0.72
0.066
0.00
2.467
0.85
0.004
0.00
2.453
0.84
0.003
PReBiM
0.81
0.062
0.89
0.036
0.78
0.063
0.89
0.031
0.80
0.053
0.87
0.038
NAIVE
-
0.394
-
0.307
-
0.479
-
0.228
-
0.457
-
0.228
MR-Egger
-
0.509
-
0.691
-
0.593
-
0.546
-
0.540
-
0.486
5k
sisVIVE
0.20
0.611
0.49
0.274
0.09
1.085
0.72
0.113
0.13
0.917
0.66
0.089
IV-TETRAD
0.37
1.479
0.56
0.312
0.25
1.869
0.69
0.165
0.30
1.641
0.63
0.164
TSHT
0.00
2.296
0.80
0.027
0.00
2.476
0.90
0.001
0.00
2.477
0.90
0.001
PReBiM
0.86
0.067
0.93
0.008
0.83
0.035
0.93
0.023
0.86
0.021
0.91
0.003
NAIVE
-
0.434
-
0.273
-
0.463
-
0.234
-
0.434
-
0.226
MR-Egger
-
0.646
-
0.593
-
0.550
-
0.560
-
0.525
-
0.443
10k
sisVIVE
0.17
0.807
0.50
0.230
0.10
1.083
0.71
0.088
0.15
0.932
0.77
0.079
IV-TETRAD
0.38
1.495
0.59
0.322
0.26
1.753
0.69
0.244
0.34
1.429
0.62
0.204
TSHT
0.00
2.370
0.85
0.022
0.00
2.494
0.92
0.001
0.00
2.486
0.93
0.000
PReBiM
0.90
0.022
0.97
0.005
0.91
0.013
0.95
0.009
0.92
0.038
0.93
0.008
Note: The symbol "−" means that methods do not output this information. "↑" means a higher value is
better, and vice versa.
H.5
Evaluating the Performance on Bi-directional MR Model with Large-Scale Datasets
In this section, we evaluate the performance of these methods in a bi-directional MR framework
with large-scale datasets. Table 6 show results of the settings S(10, 10, 30) and S(15, 15, 40). We
observe that the overall performances of all methods decrease with large-scale datasets, whereas our
method still performs more superior than other baselines.
27

Table 6: Performance comparison of NAIVE, MR-Egger, sisVIVE, IV-TETRAD, TSHT, and PRe-
BiM in estimating bi-directional MR models with large-scale datasets.
S(10, 10, 30)
S(15, 15, 40)
X →Y
Y →X
X →Y
Y →X
Size
Algorithm
CSR↑
MSE↓
CSR↑
MSE↓
CSR↑
MSE↓
CSR↑
MSE↓
NAIVE
-
0.298
-
0.292
-
0.288
-
0.299
MR-Egger
-
0.337
-
0.316
-
0.276
-
0.285
2k
sisVIVE
0.15
0.275
0.15
0.246
0.24
0.188
0.22
0.223
IV-TETRAD
0.22
0.802
0.22
0.647
0.11
0.666
0.07
0.700
TSHT
0.18
1.029
0.28
0.874
0.27
1.012
0.28
0.995
PReBiM
0.59
0.244
0.57
0.173
0.67
0.152
0.71
0.157
NAIVE
-
0.297
-
0.299
-
0.301
-
0.285
MR-Egger
-
2.307
-
0.323
-
0.293
-
0.278
5k
sisVIVE
0.15
0.247
0.14
0.281
0.23
0.236
0.23
0.200
IV-TETRAD
0.49
0.635
0.48
0.495
0.38
0.572
0.36
0.546
TSHT
0.20
1.020
0.21
1.083
0.22
0.967
0.19
1.042
PReBiM
0.72
0.079
0.73
0.102
0.81
0.094
0.77
0.075
NAIVE
-
0.301
-
0.284
-
0.307
-
0.279
MR-Egger
-
0.338
-
0.325
-
0.280
-
0.272
10k
sisVIVE
0.16
0.271
0.17
0.264
0.24
0.216
0.25
0.196
IV-TETRAD
0.58
0.443
0.62
0.390
0.53
0.535
0.53
0.432
TSHT
0.19
0.957
0.20
0.863
0.22
0.886
0.18
1.024
PReBiM
0.80
0.062
0.80
0.062
0.85
0.061
0.84
0.075
Note: The symbol "−" means that methods do not output this information. "↑" means a higher value is
better, and vice versa.
H.6
Evaluating the Performance on Bi-directional MR Model with All IVs Being Valid
In this section, we evaluate the performance of these methods in a bi-directional MR framework
with all IVs being valid. That is, only valid IVs are included in the model, either to estimate the
direction X →Y or the direction Y →X. The results in Table 7 below show the settings S(2, 2, 4).
To ensure the thoroughness of the experiment, we’ve added another setting, S(3, 3, 6). As expected,
our method gives the best results across all sample sizes and directions. As the sample size increases,
the metric CSR approaches 1, indicating that our method can identify valid IVs and also validating
our theoretical guarantees.
28

Table 7: Performance comparison of NAIVE, MR-Egger, sisVIVE, IV-TETRAD, TSHT, and PRe-
BiM in estimating bi-directional MR models across various sample sizes and three scenarios.
S(2, 2, 4)
S(3, 3, 6)
X →Y
Y →X
X →Y
Y →X
Size
Algorithm
CSR↑
MSE↓
CSR↑
MSE↓
CSR↑
MSE↓
CSR↑
MSE↓
NAIVE
-
0.413
-
0.349
-
0.351
-
0.353
MR-Egger
-
1.993
-
2.067
-
0.852
-
0.981
2k
sisVIVE
0.70
0.532
0.72
0.450
0.75
0.367
0.74
0.414
IV-TETRAD
0.63
0.822
0.35
0.792
0.68
0.651
0.29
0.716
TSHT
0.02
0.412
0.02
0.388
0.02
0.372
0.02
0.373
PReBiM
0.98
0.003
0.98
0.003
0.98
0.010
0.98
0.008
NAIVE
-
0.386
-
0.364
-
0.369
-
0.342
MR-Egger
-
2.145
-
2.570
-
0.943
-
0.952
5k
sisVIVE
0.71
0.578
0.74
0.502
0.79
0.383
0.73
0.442
IV-TETRAD
0.66
0.811
0.33
0.899
0.68
0.714
0.29
0.596
TSHT
0.01
0.415
0.02
0.387
0.01
0.355
0.01
0.370
PReBiM
0.99
0.009
0.99
0.008
0.99
0.001
0.99
0.001
NAIVE
-
0.390
-
0.374
-
0.336
-
0.364
MR-Egger
-
2.015
-
2.902
-
1.051
-
0.994
10k
sisVIVE
0.74
0.538
0.72
0.497
0.78
0.384
0.78
0.437
IV-TETRAD
0.65
0.812
0.35
0.877
0.74
0.630
0.25
0.792
TSHT
0.02
0.423
0.02
0.398
0.01
0.335
0.01
0.387
PReBiM
0.99
0.001
0.979
0.000
0.99
0.008
0.99
0.009
Note: The symbol "−" means that methods do not output this information. "↑" means a higher value is
better, and vice versa.
29

NeurIPS Paper Checklist
1. Claims
Question: Do the main claims made in the abstract and introduction accurately reﬂect the
paper’s contributions and scope?
Answer: [Yes]
Justiﬁcation: We thoroughly elaborate on our contributions and their relevance to speciﬁc
application domains in both the abstract and introduction sections.
Guidelines:
• The answer NA means that the abstract and introduction do not include the claims
made in the paper.
• The abstract and/or introduction should clearly state the claims made, including the
contributions made in the paper and important assumptions and limitations. A No or
NA answer to this question will not be perceived well by the reviewers.
• The claims made should match theoretical and experimental results, and reﬂect how
much the results can be expected to generalize to other settings.
• It is ﬁne to include aspirational goals as motivation as long as it is clear that these
goals are not attained by the paper.
2. Limitations
Question: Does the paper discuss the limitations of the work performed by the authors?
Answer: [Yes]
Justiﬁcation: We mentioned in Section 5 and Section 7 the limitations, i.e., whether our
algorithms are still feasible when the instrumental variables are dependent of each other,
and that at present our work is still limited to the case where the causal relationship is
linear. These two main issues are our future research direction.
Guidelines:
• The answer NA means that the paper has no limitation while the answer No means
that the paper has limitations, but those are not discussed in the paper.
• The authors are encouraged to create a separate "Limitations" section in their paper.
• The paper should point out any strong assumptions and how robust the results are to
violations of these assumptions (e.g., independence assumptions, noiseless settings,
model well-speciﬁcation, asymptotic approximations only holding locally). The au-
thors should reﬂect on how these assumptions might be violated in practice and what
the implications would be.
• The authors should reﬂect on the scope of the claims made, e.g., if the approach was
only tested on a few datasets or with a few runs. In general, empirical results often
depend on implicit assumptions, which should be articulated.
• The authors should reﬂect on the factors that inﬂuence the performance of the ap-
proach. For example, a facial recognition algorithm may perform poorly when image
resolution is low or images are taken in low lighting. Or a speech-to-text system might
not be used reliably to provide closed captions for online lectures because it fails to
handle technical jargon.
• The authors should discuss the computational efﬁciency of the proposed algorithms
and how they scale with dataset size.
• If applicable, the authors should discuss possible limitations of their approach to ad-
dress problems of privacy and fairness.
• While the authors might fear that complete honesty about limitations might be used by
reviewers as grounds for rejection, a worse outcome might be that reviewers discover
limitations that aren’t acknowledged in the paper. The authors should use their best
judgment and recognize that individual actions in favor of transparency play an impor-
tant role in developing norms that preserve the integrity of the community. Reviewers
will be speciﬁcally instructed to not penalize honesty concerning limitations.
3. Theory Assumptions and Proofs
30

Question: For each theoretical result, does the paper provide the full set of assumptions and
a complete (and correct) proof?
Answer: [Yes]
Justiﬁcation: We provided detailed proofs in Appendix C, Appendix D and Appendix G,
for our provided examples, propositions, and theorems, respectively.
Guidelines:
• The answer NA means that the paper does not include theoretical results.
• All the theorems, formulas, and proofs in the paper should be numbered and cross-
referenced.
• All assumptions should be clearly stated or referenced in the statement of any theo-
rems.
• The proofs can either appear in the main paper or the supplemental material, but if
they appear in the supplemental material, the authors are encouraged to provide a
short proof sketch to provide intuition.
• Inversely, any informal proof provided in the core of the paper should be comple-
mented by formal proofs provided in appendix or supplemental material.
• Theorems and Lemmas that the proof relies upon should be properly referenced.
4. Experimental Result Reproducibility
Question: Does the paper fully disclose all the information needed to reproduce the main
experimental results of the paper to the extent that it affects the main claims and/or conclu-
sions of the paper (regardless of whether the code and data are provided or not)?
Answer: [Yes]
Justiﬁcation: We show our experimental settings as well as some of the experimental results
in Section 6. In our supplementary materials, we provided the code for our algorithm as
well as a simple example. If the data is generated following our model assumptions in
Section 6, the results can be reproduced with the speciﬁed experimental settings.
Guidelines:
• The answer NA means that the paper does not include experiments.
• If the paper includes experiments, a No answer to this question will not be perceived
well by the reviewers: Making the paper reproducible is important, regardless of
whether the code and data are provided or not.
• If the contribution is a dataset and/or model, the authors should describe the steps
taken to make their results reproducible or veriﬁable.
• Depending on the contribution, reproducibility can be accomplished in various ways.
For example, if the contribution is a novel architecture, describing the architecture
fully might sufﬁce, or if the contribution is a speciﬁc model and empirical evaluation,
it may be necessary to either make it possible for others to replicate the model with
the same dataset, or provide access to the model. In general. releasing code and data
is often one good way to accomplish this, but reproducibility can also be provided via
detailed instructions for how to replicate the results, access to a hosted model (e.g., in
the case of a large language model), releasing of a model checkpoint, or other means
that are appropriate to the research performed.
• While NeurIPS does not require releasing code, the conference does require all sub-
missions to provide some reasonable avenue for reproducibility, which may depend
on the nature of the contribution. For example
(a) If the contribution is primarily a new algorithm, the paper should make it clear
how to reproduce that algorithm.
(b) If the contribution is primarily a new model architecture, the paper should describe
the architecture clearly and fully.
(c) If the contribution is a new model (e.g., a large language model), then there should
either be a way to access this model for reproducing the results or a way to re-
produce the model (e.g., with an open-source dataset or instructions for how to
construct the dataset).
31

(d) We recognize that reproducibility may be tricky in some cases, in which case au-
thors are welcome to describe the particular way they provide for reproducibility.
In the case of closed-source models, it may be that access to the model is limited in
some way (e.g., to registered users), but it should be possible for other researchers
to have some path to reproducing or verifying the results.
5. Open access to data and code
Question: Does the paper provide open access to the data and code, with sufﬁcient instruc-
tions to faithfully reproduce the main experimental results, as described in supplemental
material?
Answer: [Yes]
Justiﬁcation: We anonymized and packaged our code and data, and put them in supplemen-
tary materials.
Guidelines:
• The answer NA means that paper does not include experiments requiring code.
• Please see the NeurIPS code and data submission guidelines (https://nips.cc/
public/guides/CodeSubmissionPolicy) for more details.
• While we encourage the release of code and data, we understand that this might not
be possible, so No is an acceptable answer. Papers cannot be rejected simply for not
including code, unless this is central to the contribution (e.g., for a new open-source
benchmark).
• The instructions should contain the exact command and environment needed to run to
reproduce the results. See the NeurIPS code and data submission guidelines (https:
//nips.cc/public/guides/CodeSubmissionPolicy) for more details.
• The authors should provide instructions on data access and preparation, including how
to access the raw data, preprocessed data, intermediate data, and generated data, etc.
• The authors should provide scripts to reproduce all experimental results for the new
proposed method and baselines. If only a subset of experiments are reproducible, they
should state which ones are omitted from the script and why.
• At submission time, to preserve anonymity, the authors should release anonymized
versions (if applicable).
• Providing as much information as possible in supplemental material (appended to the
paper) is recommended, but including URLs to data and code is permitted.
6. Experimental Setting/Details
Question: Does the paper specify all the training and test details (e.g., data splits, hyper-
parameters, how they were chosen, type of optimizer, etc.) necessary to understand the
results?
Answer: [Yes]
Justiﬁcation: We placed the detailed experimental settings of the experiments in Section 6
of the paper and the complete details with the code in the supplementary materials.
Guidelines:
• The answer NA means that the paper does not include experiments.
• The experimental setting should be presented in the core of the paper to a level of
detail that is necessary to appreciate the results and make sense of them.
• The full details can be provided either with the code, in appendix, or as supplemental
material.
7. Experiment Statistical Signiﬁcance
Question: Does the paper report error bars suitably and correctly deﬁned or other appropri-
ate information about the statistical signiﬁcance of the experiments?
Answer: [Yes]
Justiﬁcation: Our experiments included mean square error (MSE) for the evaluation met-
rics, which expresses the statistical signiﬁcance of the experiment. We show it in all the
tables in the paper. It is obtained by taking the mean by calculating the square of the
difference between the estimated causal effect and the true value.
32

Guidelines:
• The answer NA means that the paper does not include experiments.
• The authors should answer "Yes" if the results are accompanied by error bars, conﬁ-
dence intervals, or statistical signiﬁcance tests, at least for the experiments that support
the main claims of the paper.
• The factors of variability that the error bars are capturing should be clearly stated (for
example, train/test split, initialization, random drawing of some parameter, or overall
run with given experimental conditions).
• The method for calculating the error bars should be explained (closed form formula,
call to a library function, bootstrap, etc.)
• The assumptions made should be given (e.g., Normally distributed errors).
• It should be clear whether the error bar is the standard deviation or the standard error
of the mean.
• It is OK to report 1-sigma error bars, but one should state it. The authors should prefer-
ably report a 2-sigma error bar than state that they have a 96% CI, if the hypothesis of
Normality of errors is not veriﬁed.
• For asymmetric distributions, the authors should be careful not to show in tables or
ﬁgures symmetric error bars that would yield results that are out of range (e.g. negative
error rates).
• If error bars are reported in tables or plots, The authors should explain in the text how
they were calculated and reference the corresponding ﬁgures or tables in the text.
8. Experiments Compute Resources
Question: For each experiment, does the paper provide sufﬁcient information on the com-
puter resources (type of compute workers, memory, time of execution) needed to reproduce
the experiments?
Answer: [Yes]
Justiﬁcation: All experiments were conducted using AMD Ryzen 7 7735H with Radeon
Graphics processors, operating at a base speed of 3.20 GHz, and equipped with 16.0 GB
(15.2 GB available) of RAM.
Guidelines:
• The answer NA means that the paper does not include experiments.
• The paper should indicate the type of compute workers CPU or GPU, internal cluster,
or cloud provider, including relevant memory and storage.
• The paper should provide the amount of compute required for each of the individual
experimental runs as well as estimate the total compute.
• The paper should disclose whether the full research project required more compute
than the experiments reported in the paper (e.g., preliminary or failed experiments
that didn’t make it into the paper).
9. Code Of Ethics
Question: Does the research conducted in the paper conform, in every respect, with the
NeurIPS Code of Ethics https://neurips.cc/public/EthicsGuidelines?
Answer: [Yes]
Justiﬁcation: Our research complies with the NeurIPS Code of Ethics.
Guidelines:
• The answer NA means that the authors have not reviewed the NeurIPS Code of Ethics.
• If the authors answer No, they should explain the special circumstances that require a
deviation from the Code of Ethics.
• The authors should make sure to preserve anonymity (e.g., if there is a special consid-
eration due to laws or regulations in their jurisdiction).
10. Broader Impacts
Question: Does the paper discuss both potential positive societal impacts and negative
societal impacts of the work performed?
33

Answer: [NA]
Justiﬁcation: Our papers are basic research.
Guidelines:
• The answer NA means that there is no societal impact of the work performed.
• If the authors answer NA or No, they should explain why their work has no societal
impact or why the paper does not address societal impact.
• Examples of negative societal impacts include potential malicious or unintended uses
(e.g., disinformation, generating fake proﬁles, surveillance), fairness considerations
(e.g., deployment of technologies that could make decisions that unfairly impact spe-
ciﬁc groups), privacy considerations, and security considerations.
• The conference expects that many papers will be foundational research and not tied
to particular applications, let alone deployments. However, if there is a direct path to
any negative applications, the authors should point it out. For example, it is legitimate
to point out that an improvement in the quality of generative models could be used to
generate deepfakes for disinformation. On the other hand, it is not needed to point out
that a generic algorithm for optimizing neural networks could enable people to train
models that generate Deepfakes faster.
• The authors should consider possible harms that could arise when the technology is
being used as intended and functioning correctly, harms that could arise when the
technology is being used as intended but gives incorrect results, and harms following
from (intentional or unintentional) misuse of the technology.
• If there are negative societal impacts, the authors could also discuss possible mitiga-
tion strategies (e.g., gated release of models, providing defenses in addition to attacks,
mechanisms for monitoring misuse, mechanisms to monitor how a system learns from
feedback over time, improving the efﬁciency and accessibility of ML).
11. Safeguards
Question: Does the paper describe safeguards that have been put in place for responsible
release of data or models that have a high risk for misuse (e.g., pretrained language models,
image generators, or scraped datasets)?
Answer: [NA]
Justiﬁcation: The study does not address this issue.
Guidelines:
• The answer NA means that the paper poses no such risks.
• Released models that have a high risk for misuse or dual-use should be released with
necessary safeguards to allow for controlled use of the model, for example by re-
quiring that users adhere to usage guidelines or restrictions to access the model or
implementing safety ﬁlters.
• Datasets that have been scraped from the Internet could pose safety risks. The authors
should describe how they avoided releasing unsafe images.
• We recognize that providing effective safeguards is challenging, and many papers do
not require this, but we encourage authors to take this into account and make a best
faith effort.
12. Licenses for existing assets
Question: Are the creators or original owners of assets (e.g., code, data, models), used in
the paper, properly credited and are the license and terms of use explicitly mentioned and
properly respected?
Answer: [NA]
Justiﬁcation: The study does not address this issue.
Guidelines:
• The answer NA means that the paper does not use existing assets.
• The authors should cite the original paper that produced the code package or dataset.
• The authors should state which version of the asset is used and, if possible, include a
URL.
34

• The name of the license (e.g., CC-BY 4.0) should be included for each asset.
• For scraped data from a particular source (e.g., website), the copyright and terms of
service of that source should be provided.
• If assets are released, the license, copyright information, and terms of use in the pack-
age should be provided. For popular datasets, paperswithcode.com/datasets has
curated licenses for some datasets. Their licensing guide can help determine the li-
cense of a dataset.
• For existing datasets that are re-packaged, both the original license and the license of
the derived asset (if it has changed) should be provided.
• If this information is not available online, the authors are encouraged to reach out to
the asset’s creators.
13. New Assets
Question: Are new assets introduced in the paper well documented and is the documenta-
tion provided alongside the assets?
Answer: [NA]
Justiﬁcation: The study does not address this issue.
Guidelines:
• The answer NA means that the paper does not release new assets.
• Researchers should communicate the details of the dataset/code/model as part of their
submissions via structured templates. This includes details about training, license,
limitations, etc.
• The paper should discuss whether and how consent was obtained from people whose
asset is used.
• At submission time, remember to anonymize your assets (if applicable). You can
either create an anonymized URL or include an anonymized zip ﬁle.
14. Crowdsourcing and Research with Human Subjects
Question: For crowdsourcing experiments and research with human subjects, does the pa-
per include the full text of instructions given to participants and screenshots, if applicable,
as well as details about compensation (if any)?
Answer: [NA]
Justiﬁcation: The study does not address this issue.
Guidelines:
• The answer NA means that the paper does not involve crowdsourcing nor research
with human subjects.
• Including this information in the supplemental material is ﬁne, but if the main contri-
bution of the paper involves human subjects, then as much detail as possible should
be included in the main paper.
• According to the NeurIPS Code of Ethics, workers involved in data collection, cura-
tion, or other labor should be paid at least the minimum wage in the country of the
data collector.
15. Institutional Review Board (IRB) Approvals or Equivalent for Research with Human
Subjects
Question: Does the paper describe potential risks incurred by study participants, whether
such risks were disclosed to the subjects, and whether Institutional Review Board (IRB)
approvals (or an equivalent approval/review based on the requirements of your country or
institution) were obtained?
Answer: [NA]
Justiﬁcation: The study does not address this issue.
Guidelines:
• The answer NA means that the paper does not involve crowdsourcing nor research
with human subjects.
35

• Depending on the country in which research is conducted, IRB approval (or equiva-
lent) may be required for any human subjects research. If you obtained IRB approval,
you should clearly state this in the paper.
• We recognize that the procedures for this may vary signiﬁcantly between institutions
and locations, and we expect authors to adhere to the NeurIPS Code of Ethics and the
guidelines for their institution.
• For initial submissions, do not include any information that would break anonymity
(if applicable), such as the institution conducting the review.
36

